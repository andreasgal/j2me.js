!function(){if(Date.now||(Date.now=function(){return(new Date).getTime()}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var i,s,f=[];for(i in o)t.call(o,i)&&f.push(i);if(e)for(s=0;r>s;s++)t.call(o,n[s])&&f.push(n[s]);return f}}()),"b"!=="ab".substr(-1)&&(String.prototype.substr=function(t){return function(e,n){return 0>e&&(e=this.length+e),t.call(this,e,n)}}(String.prototype.substr)),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var n=0;n<this.length;++n)n in this&&t.call(e,this[n],n,this)}),"undefined"==typeof setImmediate){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:global,e=[],n="zero-timeout-message",r=function(){if("undefined"!=typeof t.importScripts||!t.postMessage)return!1;var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e};if(r()){t.setImmediate=function(r){e.push(r),t.postMessage(n,"*")};var o=function(t){if(t.source===self&&t.data===n&&(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,e.length>0)){var r=e.shift();return r()}};t.addEventListener?t.addEventListener("message",o,!0):t.attachEvent("onmessage",o)}else if(t.MessageChannel){var i=new t.MessageChannel;i.port1.onmessage=function(){return e.length>0?e.shift()():void 0},t.setImmediate=function(t){e.push(t),i.port2.postMessage("")}}else t.setImmediate=function(t){return setTimeout(t,0)}}Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if("undefined"==typeof e&&(e=0),!this)throw new TypeError;var n=this.length;if(0===n||r>=n)return-1;var r=e;0>r&&(r=n+r);for(var o=r;n>o;o++)if(this[o]===t)return o;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var n,r;for(n=0,r=this.length;r>n;++n)n in this&&t.call(e,this[n],n,this)}),Array.prototype.map||(Array.prototype.map=function(t,e){var n,r,o;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),s=i.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(e&&(n=e),r=new Array(s),o=0;s>o;){var f,a;o in i&&(f=i[o],a=t.call(n,f,o,i),r[o]=a),o++}return r}),"undefined"!=typeof document&&void 0===window.chrome&&document.write("<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n Dim lastIndex\r\n lastIndex = LenB(Binary)\r\n if lastIndex mod 2 Then\r\n IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n Else\r\n IEBinaryToArray_ByteStr_Last = \"\"\r\n End If\r\nEnd Function\r\n</script>\r\n");var s,f,a;!function(t){function e(t,e){return E.call(t,e)}function n(t,e){var n,r,o,i,s,f,a,u,c,h,p,d=e&&e.split("/"),l=m.map,y=l&&l["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),s=t.length-1,m.nodeIdCompat&&S.test(t[s])&&(t[s]=t[s].replace(S,"")),t=d.concat(t),c=0;c<t.length;c+=1)if(p=t[c],"."===p)t.splice(c,1),c-=1;else if(".."===p){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||y)&&l){for(n=t.split("/"),c=n.length;c>0;c-=1){if(r=n.slice(0,c).join("/"),d)for(h=d.length;h>0;h-=1)if(o=l[d.slice(0,h).join("/")],o&&(o=o[r])){i=o,f=c;break}if(i)break;!a&&y&&y[r]&&(a=y[r],u=c)}!i&&a&&(i=a,f=u),i&&(n.splice(0,f,i),t=n.join("/"))}return t}function r(e,n){return function(){return d.apply(t,b.call(arguments,0).concat([e,n]))}}function o(t){return function(e){return n(e,t)}}function i(t){return function(e){w[t]=e}}function u(n){if(e(g,n)){var r=g[n];delete g[n],v[n]=!0,p.apply(t,r)}if(!e(w,n)&&!e(v,n))throw new Error("No "+n);return w[n]}function c(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function h(t){return function(){return m&&m.config&&m.config[t]||{}}}var p,d,l,y,w={},g={},m={},v={},E=Object.prototype.hasOwnProperty,b=[].slice,S=/\.js$/;l=function(t,e){var r,i=c(t),s=i[0];return t=i[1],s&&(s=n(s,e),r=u(s)),s?t=r&&r.normalize?r.normalize(t,o(e)):n(t,e):(t=n(t,e),i=c(t),s=i[0],t=i[1],s&&(r=u(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:r}},y={require:function(t){return r(t)},exports:function(t){var e=w[t];return"undefined"!=typeof e?e:w[t]={}},module:function(t){return{id:t,uri:"",exports:w[t],config:h(t)}}},p=function(n,o,s,f){var a,c,h,p,d,m,E=[],b=typeof s;if(f=f||n,"undefined"===b||"function"===b){for(o=!o.length&&s.length?["require","exports","module"]:o,d=0;d<o.length;d+=1)if(p=l(o[d],f),c=p.f,"require"===c)E[d]=y.require(n);else if("exports"===c)E[d]=y.exports(n),m=!0;else if("module"===c)a=E[d]=y.module(n);else if(e(w,c)||e(g,c)||e(v,c))E[d]=u(c);else{if(!p.p)throw new Error(n+" missing "+c);p.p.load(p.n,r(f,!0),i(c),{}),E[d]=w[c]}h=s?s.apply(w[n],E):void 0,n&&(a&&a.exports!==t&&a.exports!==w[n]?w[n]=a.exports:h===t&&m||(w[n]=h))}else n&&(w[n]=s)},s=f=d=function(e,n,r,o,i){if("string"==typeof e)return y[e]?y[e](n):u(l(e,n).f);if(!e.splice){if(m=e,m.deps&&d(m.deps,m.callback),!n)return;n.splice?(e=n,n=r,r=null):e=t}return n=n||function(){},"function"==typeof r&&(r=o,o=i),o?p(t,e,n,r):setTimeout(function(){p(t,e,n,r)},4),d},d.config=function(t){return d(t)},s._defined=w,a=function(t,n,r){n.splice||(r=n,n=[]),e(w,t)||e(g,t)||(g[t]=[t,n,r])},a.amd={jQuery:!0}}(),a("../../vendor/almond/almond",function(){}),a("core/api_error",["require","exports"],function(t,e){!function(t){t[t.EPERM=0]="EPERM",t[t.ENOENT=1]="ENOENT",t[t.EIO=2]="EIO",t[t.EBADF=3]="EBADF",t[t.EACCES=4]="EACCES",t[t.EBUSY=5]="EBUSY",t[t.EEXIST=6]="EEXIST",t[t.ENOTDIR=7]="ENOTDIR",t[t.EISDIR=8]="EISDIR",t[t.EINVAL=9]="EINVAL",t[t.EFBIG=10]="EFBIG",t[t.ENOSPC=11]="ENOSPC",t[t.EROFS=12]="EROFS",t[t.ENOTEMPTY=13]="ENOTEMPTY",t[t.ENOTSUP=14]="ENOTSUP"}(e.ErrorCode||(e.ErrorCode={}));var n=e.ErrorCode,r={};r[0]="Operation not permitted.",r[1]="No such file or directory.",r[2]="Input/output error.",r[3]="Bad file descriptor.",r[4]="Permission denied.",r[5]="Resource busy or locked.",r[6]="File exists.",r[7]="File is not a directory.",r[8]="File is a directory.",r[9]="Invalid argument.",r[10]="File is too big.",r[11]="No space left on disk.",r[12]="Cannot modify a read-only file system.",r[13]="Directory is not empty.",r[14]="Operation is not supported.";var o=function(){function t(t,e){this.type=t,this.code=n[t],this.message=null!=e?e:r[t]}return t.prototype.toString=function(){return this.code+": "+r[this.type]+" "+this.message},t.FileError=function(e,n){return new t(e,n+": "+r[e])},t.ENOENT=function(t){return this.FileError(1,t)},t.EEXIST=function(t){return this.FileError(6,t)},t.EISDIR=function(t){return this.FileError(8,t)},t.ENOTDIR=function(t){return this.FileError(7,t)},t.EPERM=function(t){return this.FileError(0,t)},t}();e.ApiError=o}),a("core/buffer_core",["require","exports","./api_error"],function(t,e,n){var r=Math.pow(2,128),o=-1*r,i=2139095040,s=-8388608,f=2143289344,a=function(){function t(){}return t.prototype.getLength=function(){throw new n.ApiError(14,"BufferCore implementations should implement getLength.")},t.prototype.writeInt8=function(t,e){this.writeUInt8(t,255&e|(2147483648&e)>>>24)},t.prototype.writeInt16LE=function(t,e){this.writeUInt8(t,255&e),this.writeUInt8(t+1,e>>>8&255|(2147483648&e)>>>24)},t.prototype.writeInt16BE=function(t,e){this.writeUInt8(t+1,255&e),this.writeUInt8(t,e>>>8&255|(2147483648&e)>>>24)},t.prototype.writeInt32LE=function(t,e){this.writeUInt8(t,255&e),this.writeUInt8(t+1,e>>>8&255),this.writeUInt8(t+2,e>>>16&255),this.writeUInt8(t+3,e>>>24&255)},t.prototype.writeInt32BE=function(t,e){this.writeUInt8(t+3,255&e),this.writeUInt8(t+2,e>>>8&255),this.writeUInt8(t+1,e>>>16&255),this.writeUInt8(t,e>>>24&255)},t.prototype.writeUInt8=function(){throw new n.ApiError(14,"BufferCore implementations should implement writeUInt8.")},t.prototype.writeUInt16LE=function(t,e){this.writeUInt8(t,255&e),this.writeUInt8(t+1,e>>8&255)},t.prototype.writeUInt16BE=function(t,e){this.writeUInt8(t+1,255&e),this.writeUInt8(t,e>>8&255)},t.prototype.writeUInt32LE=function(t,e){this.writeInt32LE(t,0|e)},t.prototype.writeUInt32BE=function(t,e){this.writeInt32BE(t,0|e)},t.prototype.writeFloatLE=function(t,e){this.writeInt32LE(t,this.float2intbits(e))},t.prototype.writeFloatBE=function(t,e){this.writeInt32BE(t,this.float2intbits(e))},t.prototype.writeDoubleLE=function(t,e){var n=this.double2longbits(e);this.writeInt32LE(t,n[0]),this.writeInt32LE(t+4,n[1])},t.prototype.writeDoubleBE=function(t,e){var n=this.double2longbits(e);this.writeInt32BE(t+4,n[0]),this.writeInt32BE(t,n[1])},t.prototype.readInt8=function(t){var e=this.readUInt8(t);return 128&e?4294967168|e:e},t.prototype.readInt16LE=function(t){var e=this.readUInt16LE(t);return 32768&e?4294934528|e:e},t.prototype.readInt16BE=function(t){var e=this.readUInt16BE(t);return 32768&e?4294934528|e:e},t.prototype.readInt32LE=function(t){return 0|this.readUInt32LE(t)},t.prototype.readInt32BE=function(t){return 0|this.readUInt32BE(t)},t.prototype.readUInt8=function(){throw new n.ApiError(14,"BufferCore implementations should implement readUInt8.")},t.prototype.readUInt16LE=function(t){return this.readUInt8(t+1)<<8|this.readUInt8(t)},t.prototype.readUInt16BE=function(t){return this.readUInt8(t)<<8|this.readUInt8(t+1)},t.prototype.readUInt32LE=function(t){return(this.readUInt8(t+3)<<24|this.readUInt8(t+2)<<16|this.readUInt8(t+1)<<8|this.readUInt8(t))>>>0},t.prototype.readUInt32BE=function(t){return(this.readUInt8(t)<<24|this.readUInt8(t+1)<<16|this.readUInt8(t+2)<<8|this.readUInt8(t+3))>>>0},t.prototype.readFloatLE=function(t){return this.intbits2float(this.readInt32LE(t))},t.prototype.readFloatBE=function(t){return this.intbits2float(this.readInt32BE(t))},t.prototype.readDoubleLE=function(t){return this.longbits2double(this.readInt32LE(t+4),this.readInt32LE(t))},t.prototype.readDoubleBE=function(t){return this.longbits2double(this.readInt32BE(t),this.readInt32BE(t+4))},t.prototype.copy=function(){throw new n.ApiError(14,"BufferCore implementations should implement copy.")},t.prototype.fill=function(t,e,n){for(var r=e;n>r;r++)this.writeUInt8(r,t)},t.prototype.float2intbits=function(t){var e,n,r;return 0===t?0:t===Number.POSITIVE_INFINITY?i:t===Number.NEGATIVE_INFINITY?s:isNaN(t)?f:(r=0>t?1:0,t=Math.abs(t),1.1754942106924411e-38>=t&&t>=1.401298464324817e-45?(e=0,n=Math.round(t/Math.pow(2,-126)*Math.pow(2,23)),r<<31|e<<23|n):(e=Math.floor(Math.log(t)/Math.LN2),n=Math.round((t/Math.pow(2,e)-1)*Math.pow(2,23)),r<<31|e+127<<23|n))},t.prototype.double2longbits=function(t){var e,n,r,o;return 0===t?[0,0]:t===Number.POSITIVE_INFINITY?[0,2146435072]:t===Number.NEGATIVE_INFINITY?[0,-1048576]:isNaN(t)?[0,2146959360]:(o=0>t?1<<31:0,t=Math.abs(t),2.225073858507201e-308>=t&&t>=5e-324?(e=0,r=t/Math.pow(2,-1022)*Math.pow(2,52)):(e=Math.floor(Math.log(t)/Math.LN2),t<Math.pow(2,e)&&(e-=1),r=(t/Math.pow(2,e)-1)*Math.pow(2,52),e=e+1023<<20),n=r*Math.pow(2,-32)|0|o|e,[65535&r,n])},t.prototype.intbits2float=function(t){if(t===i)return Number.POSITIVE_INFINITY;if(t===s)return Number.NEGATIVE_INFINITY;var e,n=(2147483648&t)>>>31,f=(2139095040&t)>>>23,a=8388607&t;return e=0===f?Math.pow(-1,n)*a*Math.pow(2,-149):Math.pow(-1,n)*(1+a*Math.pow(2,-23))*Math.pow(2,f-127),(o>e||e>r)&&(e=0/0),e},t.prototype.longbits2double=function(t,e){var n=(2147483648&t)>>>31,r=(2146435072&t)>>>20,o=(1048575&t)*Math.pow(2,32)+e;return 0===r&&0===o?0:2047===r?0===o?1===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:0/0:0===r?Math.pow(-1,n)*o*Math.pow(2,-1074):Math.pow(-1,n)*(1+o*Math.pow(2,-52))*Math.pow(2,r-1023)},t}();e.BufferCoreCommon=a});var u=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};a("core/buffer_core_array",["require","exports","./buffer_core"],function(t,e,n){var r=[4294967040,4294902015,4278255615,16777215],o=function(t){function e(e){t.call(this),this.length=e,this.buff=new Array(Math.ceil(e/4));for(var n=this.buff.length,r=0;n>r;r++)this.buff[r]=0}return u(e,t),e.isAvailable=function(){return!0},e.prototype.getLength=function(){return this.length},e.prototype.writeUInt8=function(t,e){e&=255;var n=t>>2,o=3&t;this.buff[n]=this.buff[n]&r[o],this.buff[n]=this.buff[n]|e<<(o<<3)},e.prototype.readUInt8=function(t){var e=t>>2,n=3&t;return this.buff[e]>>(n<<3)&255},e.prototype.copy=function(t,n){for(var r=new e(n-t),o=t;n>o;o++)r.writeUInt8(o-t,this.readUInt8(o));return r},e}(n.BufferCoreCommon);e.BufferCoreArray=o});var u=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};a("core/buffer_core_arraybuffer",["require","exports","./buffer_core"],function(t,e,n){var r=function(t){function e(e){t.call(this),this.buff="number"==typeof e?new DataView(new ArrayBuffer(e)):e instanceof DataView?e:new DataView(e),this.length=this.buff.byteLength}return u(e,t),e.isAvailable=function(){return"undefined"!=typeof DataView},e.prototype.getLength=function(){return this.length},e.prototype.writeInt8=function(t,e){this.buff.setInt8(t,e)},e.prototype.writeInt16LE=function(t,e){this.buff.setInt16(t,e,!0)},e.prototype.writeInt16BE=function(t,e){this.buff.setInt16(t,e,!1)},e.prototype.writeInt32LE=function(t,e){this.buff.setInt32(t,e,!0)},e.prototype.writeInt32BE=function(t,e){this.buff.setInt32(t,e,!1)},e.prototype.writeUInt8=function(t,e){this.buff.setUint8(t,e)},e.prototype.writeUInt16LE=function(t,e){this.buff.setUint16(t,e,!0)},e.prototype.writeUInt16BE=function(t,e){this.buff.setUint16(t,e,!1)},e.prototype.writeUInt32LE=function(t,e){this.buff.setUint32(t,e,!0)},e.prototype.writeUInt32BE=function(t,e){this.buff.setUint32(t,e,!1)},e.prototype.writeFloatLE=function(t,e){this.buff.setFloat32(t,e,!0)},e.prototype.writeFloatBE=function(t,e){this.buff.setFloat32(t,e,!1)},e.prototype.writeDoubleLE=function(t,e){this.buff.setFloat64(t,e,!0)},e.prototype.writeDoubleBE=function(t,e){this.buff.setFloat64(t,e,!1)},e.prototype.readInt8=function(t){return this.buff.getInt8(t)},e.prototype.readInt16LE=function(t){return this.buff.getInt16(t,!0)},e.prototype.readInt16BE=function(t){return this.buff.getInt16(t,!1)},e.prototype.readInt32LE=function(t){return this.buff.getInt32(t,!0)},e.prototype.readInt32BE=function(t){return this.buff.getInt32(t,!1)},e.prototype.readUInt8=function(t){return this.buff.getUint8(t)},e.prototype.readUInt16LE=function(t){return this.buff.getUint16(t,!0)},e.prototype.readUInt16BE=function(t){return this.buff.getUint16(t,!1)},e.prototype.readUInt32LE=function(t){return this.buff.getUint32(t,!0)},e.prototype.readUInt32BE=function(t){return this.buff.getUint32(t,!1)},e.prototype.readFloatLE=function(t){return this.buff.getFloat32(t,!0)},e.prototype.readFloatBE=function(t){return this.buff.getFloat32(t,!1)},e.prototype.readDoubleLE=function(t){return this.buff.getFloat64(t,!0)},e.prototype.readDoubleBE=function(t){return this.buff.getFloat64(t,!1)},e.prototype.copy=function(t,n){var r,o=this.buff.buffer;if(ArrayBuffer.prototype.slice)r=o.slice(t,n);else{var i=n-t;r=new ArrayBuffer(i);var s=new Uint8Array(r),f=new Uint8Array(o);s.set(f.subarray(t,n))}return new e(r)},e.prototype.fill=function(t,e,n){t=255&t;var r,o=n-e,i=4*(o/4|0),s=t<<24|t<<16|t<<8|t;for(r=0;i>r;r+=4)this.writeInt32LE(r+e,s);for(r=i;o>r;r++)this.writeUInt8(r+e,t)},e.prototype.getDataView=function(){return this.buff},e}(n.BufferCoreCommon);e.BufferCoreArrayBuffer=r});var u=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};a("core/buffer_core_imagedata",["require","exports","./buffer_core"],function(t,e,n){var r=function(t){function e(n){t.call(this),this.length=n,this.buff=e.getCanvasPixelArray(n)}return u(e,t),e.getCanvasPixelArray=function(t){var n=e.imageDataFactory;return void 0===n&&(e.imageDataFactory=n=document.createElement("canvas").getContext("2d")),0===t&&(t=1),n.createImageData(Math.ceil(t/4),1).data},e.isAvailable=function(){return"undefined"!=typeof CanvasPixelArray},e.prototype.getLength=function(){return this.length},e.prototype.writeUInt8=function(t,e){this.buff[t]=e},e.prototype.readUInt8=function(t){return this.buff[t]},e.prototype.copy=function(t,n){for(var r=new e(n-t),o=t;n>o;o++)r.writeUInt8(o-t,this.buff[o]);return r},e}(n.BufferCoreCommon);e.BufferCoreImageData=r}),a("core/string_util",["require","exports"],function(t,e){function n(t){switch(t=function(){switch(typeof t){case"object":return""+t;case"string":return t;default:throw new Error("Invalid encoding argument specified")}}(),t=t.toLowerCase()){case"utf8":case"utf-8":return r;case"ascii":return o;case"binary":return s;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a;case"hex":return u;case"base64":return f;case"binary_string":return c;case"binary_string_ie":return h;case"extended_ascii":return i;default:throw new Error("Unknown encoding: "+t)}}e.FindUtil=n;var r=function(){function t(){}return t.str2byte=function(t,e){for(var n=e.length,r=0,o=0,i=n,s=0;r<t.length&&i>o;){var f=t.charCodeAt(r++),a=t.charCodeAt(r);if(f>=55296&&56319>=f&&a>=56320&&57343>=a){if(o+3>=i)break;s++;var u=(1023&f|1024)<<10|1023&a;e.writeUInt8(u>>18|240,o++),e.writeUInt8(u>>12&63|128,o++),e.writeUInt8(u>>6&63|128,o++),e.writeUInt8(63&u|128,o++),r++}else if(128>f)e.writeUInt8(f,o++),s++;else if(2048>f){if(o+1>=i)break;s++,e.writeUInt8(f>>6|192,o++),e.writeUInt8(63&f|128,o++)}else if(65536>f){if(o+2>=i)break;s++,e.writeUInt8(f>>12|224,o++),e.writeUInt8(f>>6&63|128,o++),e.writeUInt8(63&f|128,o++)}}return o},t.byte2str=function(t){for(var e=[],n=0;n<t.length;){var r=t.readUInt8(n++);if(128>r)e.push(String.fromCharCode(r));else{if(192>r)throw new Error("Found incomplete part of character in string.");if(224>r)e.push(String.fromCharCode((31&r)<<6|63&t.readUInt8(n++)));else if(240>r)e.push(String.fromCharCode((15&r)<<12|(63&t.readUInt8(n++))<<6|63&t.readUInt8(n++)));else{if(!(248>r))throw new Error("Unable to represent UTF-8 string as UTF-16 JavaScript string.");var o=t.readUInt8(n+2);e.push(String.fromCharCode(1023&((7&r)<<8|(63&t.readUInt8(n++))<<2|(63&t.readUInt8(n++))>>4)|55296)),e.push(String.fromCharCode((15&o)<<6|63&t.readUInt8(n++)|56320))}}}return e.join("")},t.byteLength=function(t){var e=encodeURIComponent(t).match(/%[89ABab]/g);return t.length+(e?e.length:0)},t}();e.UTF8=r;var o=function(){function t(){}return t.str2byte=function(t,e){for(var n=t.length>e.length?e.length:t.length,r=0;n>r;r++)e.writeUInt8(t.charCodeAt(r)%256,r);return n},t.byte2str=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=String.fromCharCode(127&t.readUInt8(n));return e.join("")},t.byteLength=function(t){return t.length},t}();e.ASCII=o;var i=function(){function t(){}return t.str2byte=function(e,n){for(var r=e.length>n.length?n.length:e.length,o=0;r>o;o++){var i=e.charCodeAt(o);if(i>127){var s=t.extendedChars.indexOf(e.charAt(o));s>-1&&(i=s+128)}n.writeUInt8(i,o)}return r},t.byte2str=function(e){for(var n=new Array(e.length),r=0;r<e.length;r++){var o=e.readUInt8(r);n[r]=o>127?t.extendedChars[o-128]:String.fromCharCode(o)}return n.join("")},t.byteLength=function(t){return t.length},t.extendedChars=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "],t}();e.ExtendedASCII=i;var s=function(){function t(){}return t.str2byte=function(t,e){for(var n=t.length>e.length?e.length:t.length,r=0;n>r;r++)e.writeUInt8(255&t.charCodeAt(r),r);return n},t.byte2str=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=String.fromCharCode(255&t.readUInt8(n));return e.join("")},t.byteLength=function(t){return t.length},t}();e.BINARY=s;var f=function(){function t(){}return t.byte2str=function(e){for(var n="",r=0;r<e.length;){var o=e.readUInt8(r++),i=r<e.length?e.readUInt8(r++):0/0,s=r<e.length?e.readUInt8(r++):0/0,f=o>>2,a=(3&o)<<4|i>>4,u=(15&i)<<2|s>>6,c=63&s;isNaN(i)?u=c=64:isNaN(s)&&(c=64),n=n+t.num2b64[f]+t.num2b64[a]+t.num2b64[u]+t.num2b64[c]}return n},t.str2byte=function(e,n){var r=n.length,o="",i=0;e=e.replace(/[^A-Za-z0-9\+\/\=\-\_]/g,"");for(var s=0;i<e.length;){var f=t.b642num[e.charAt(i++)],a=t.b642num[e.charAt(i++)],u=t.b642num[e.charAt(i++)],c=t.b642num[e.charAt(i++)],h=f<<2|a>>4,p=(15&a)<<4|u>>2,d=(3&u)<<6|c;if(n.writeUInt8(h,s++),s===r)break;if(64!==u&&(o+=n.writeUInt8(p,s++)),s===r)break;if(64!==c&&(o+=n.writeUInt8(d,s++)),s===r)break}return s},t.byteLength=function(t){return Math.floor(6*t.replace(/[^A-Za-z0-9\+\/\-\_]/g,"").length/8)},t.b64chars=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/","="],t.num2b64=function(){for(var e=new Array(t.b64chars.length),n=0;n<t.b64chars.length;n++){var r=t.b64chars[n];e[n]=r}return e}(),t.b642num=function(){for(var e={},n=0;n<t.b64chars.length;n++){var r=t.b64chars[n];e[r]=n}return e["-"]=62,e._=63,e}(),t}();e.BASE64=f;var a=function(){function t(){}return t.str2byte=function(t,e){var n=t.length;2*n>e.length&&(n=e.length%2===1?(e.length-1)/2:e.length/2);for(var r=0;n>r;r++)e.writeUInt16LE(t.charCodeAt(r),2*r);return 2*n},t.byte2str=function(t){if(t.length%2!==0)throw new Error("Invalid UCS2 byte array.");for(var e=new Array(t.length/2),n=0;n<t.length;n+=2)e[n/2]=String.fromCharCode(t.readUInt8(n)|t.readUInt8(n+1)<<8);return e.join("")},t.byteLength=function(t){return 2*t.length},t}();e.UCS2=a;var u=function(){function t(){}return t.str2byte=function(t,e){if(t.length%2===1)throw new Error("Invalid hex string");var n=t.length>>1;n>e.length&&(n=e.length);for(var r=0;n>r;r++){var o=this.hex2num[t.charAt(r<<1)],i=this.hex2num[t.charAt((r<<1)+1)];e.writeUInt8(o<<4|i,r)}return n},t.byte2str=function(t){for(var e=t.length,n=new Array(e<<1),r=0,o=0;e>o;o++){var i=15&t.readUInt8(o),s=t.readUInt8(o)>>4;n[r++]=this.num2hex[s],n[r++]=this.num2hex[i]}return n.join("")},t.byteLength=function(t){return t.length>>1},t.HEXCHARS="0123456789abcdef",t.num2hex=function(){for(var e=new Array(t.HEXCHARS.length),n=0;n<t.HEXCHARS.length;n++){var r=t.HEXCHARS[n];e[n]=r}return e}(),t.hex2num=function(){var e,n,r={};for(e=0;e<t.HEXCHARS.length;e++)n=t.HEXCHARS[e],r[n]=e;var o="ABCDEF";for(e=0;e<o.length;e++)n=o[e],r[n]=e+10;return r}(),t}();e.HEX=u;var c=function(){function t(){}return t.str2byte=function(e,n){if(0===e.length)return 0;var r=t.byteLength(e);r>n.length&&(r=n.length);var o=0,i=0,s=i+r,f=e.charCodeAt(o++);0!==f&&(n.writeUInt8(255&f,0),i=1);for(var a=i;s>a;a+=2){var u=e.charCodeAt(o++);s-a===1&&n.writeUInt8(u>>8,a),s-a>=2&&n.writeUInt16BE(u,a)}return r},t.byte2str=function(t){var e=t.length;if(0===e)return"";for(var n=new Array((e>>1)+1),r=0,o=0;o<n.length;o++)n[o]=String.fromCharCode(0===o?e%2===1?256|t.readUInt8(r++):0:t.readUInt8(r++)<<8|t.readUInt8(r++));return n.join("")},t.byteLength=function(t){if(0===t.length)return 0;var e=t.charCodeAt(0),n=t.length-1<<1;return 0!==e&&n++,n},t}();e.BINSTR=c;var h=function(){function t(){}return t.str2byte=function(t,e){for(var n=t.length>e.length?e.length:t.length,r=0;n>r;r++)e.writeUInt8(t.charCodeAt(r)-32,r);return n},t.byte2str=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=String.fromCharCode(t.readUInt8(n)+32);return e.join("")},t.byteLength=function(t){return t.length},t}();e.BINSTRIE=h}),a("core/buffer",["require","exports","./buffer_core","./buffer_core_array","./buffer_core_arraybuffer","./buffer_core_imagedata","./string_util"],function(t,e,n,r,o,i,s){var f=[o.BufferCoreArrayBuffer,i.BufferCoreImageData,r.BufferCoreArray],a=function(){var t,e;for(t=0;t<f.length;t++)if(e=f[t],e.isAvailable())return e;throw new Error("This browser does not support any available BufferCore implementations.")}(),u=function(){function t(e,r,i){"undefined"==typeof r&&(r="utf8"),this.offset=0;var s;if(!(this instanceof t))return new t(e,r);if(e instanceof n.BufferCoreCommon){this.data=e;var f="number"==typeof r?r:0,u="number"==typeof i?i:this.data.getLength();this.offset=f,this.length=u-f}else if("number"==typeof e){if(e!==e>>>0)throw new TypeError("Buffer size must be a uint32.");this.length=e,this.data=new a(e)}else if("undefined"!=typeof DataView&&e instanceof DataView)this.data=new o.BufferCoreArrayBuffer(e),this.length=e.byteLength;else if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)this.data=new o.BufferCoreArrayBuffer(e),this.length=e.byteLength;else if(e instanceof t){var c=e;this.data=new a(e.length),this.length=e.length,c.copy(this)}else if(Array.isArray(e)||null!=e&&"object"==typeof e&&"number"==typeof e[0]){for(this.data=new a(e.length),s=0;s<e.length;s++)this.data.writeUInt8(s,e[s]);this.length=e.length}else{if("string"!=typeof e)throw new Error("Invalid argument to Buffer constructor: "+e);this.length=t.byteLength(e,r),this.data=new a(this.length),this.write(e,0,this.length,r)}}return t.prototype.getBufferCore=function(){return this.data},t.prototype.getOffset=function(){return this.offset},t.prototype.set=function(t,e){return 0>e?this.writeInt8(e,t):this.writeUInt8(e,t)},t.prototype.get=function(t){return this.readUInt8(t)},t.prototype.write=function(e,n,r,o){if("undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=this.length),"undefined"==typeof o&&(o="utf8"),"string"==typeof n?(o=""+n,n=0,r=this.length):"string"==typeof r&&(o=""+r,r=this.length),n>=this.length)return 0;var i=s.FindUtil(o);return r=r+n>this.length?this.length-n:r,n+=this.offset,i.str2byte(e,0===n&&r===this.length?this:new t(this.data,n,r+n))},t.prototype.toString=function(e,n,r){if("undefined"==typeof e&&(e="utf8"),"undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=this.length),!(r>=n))throw new Error("Invalid start/end positions: "+n+" - "+r);if(n===r)return"";r>this.length&&(r=this.length);var o=s.FindUtil(e);return o.byte2str(0===n&&r===this.length?this:new t(this.data,n+this.offset,r+this.offset))},t.prototype.toJSON=function(){for(var t=this.length,e=new Array(t),n=0;t>n;n++)e[n]=this.readUInt8(n);return{type:"Buffer",data:e}},t.prototype.copy=function(t,e,n,r){if("undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=this.length),e=0>e?0:e,n=0>n?0:n,n>r)throw new RangeError("sourceEnd < sourceStart");if(r===n)return 0;if(e>=t.length)throw new RangeError("targetStart out of bounds");if(n>=this.length)throw new RangeError("sourceStart out of bounds");if(r>this.length)throw new RangeError("sourceEnd out of bounds");for(var o=Math.min(r-n,t.length-e,this.length-n),i=0;o>i;i++)t.writeUInt8(this.readUInt8(n+i),e+i);return o},t.prototype.slice=function(e,n){if("undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=this.length),0>e&&(e+=this.length,0>e&&(e=0)),0>n&&(n+=this.length,0>n&&(n=0)),n>this.length&&(n=this.length),e>n&&(e=n),0>e||0>n||e>=this.length||n>this.length)throw new Error("Invalid slice indices.");return new t(this.data,e+this.offset,n+this.offset)},t.prototype.sliceCopy=function(e,n){if("undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=this.length),0>e&&(e+=this.length,0>e&&(e=0)),0>n&&(n+=this.length,0>n&&(n=0)),n>this.length&&(n=this.length),e>n&&(e=n),0>e||0>n||e>=this.length||n>this.length)throw new Error("Invalid slice indices.");return new t(this.data.copy(e+this.offset,n+this.offset))},t.prototype.fill=function(t,e,n){"undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=this.length);var r=typeof t;switch(r){case"string":t=255&t.charCodeAt(0);break;case"number":break;default:throw new Error("Invalid argument to fill.")}e+=this.offset,n+=this.offset,this.data.fill(t,e,n)},t.prototype.readUInt8=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readUInt8(t)},t.prototype.readUInt16LE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readUInt16LE(t)},t.prototype.readUInt16BE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readUInt16BE(t)},t.prototype.readUInt32LE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readUInt32LE(t)},t.prototype.readUInt32BE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readUInt32BE(t)},t.prototype.readInt8=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readInt8(t)},t.prototype.readInt16LE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readInt16LE(t)},t.prototype.readInt16BE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readInt16BE(t)},t.prototype.readInt32LE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readInt32LE(t)},t.prototype.readInt32BE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readInt32BE(t)},t.prototype.readFloatLE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readFloatLE(t)},t.prototype.readFloatBE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readFloatBE(t)},t.prototype.readDoubleLE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readDoubleLE(t)},t.prototype.readDoubleBE=function(t,e){return"undefined"==typeof e&&(e=!1),t+=this.offset,this.data.readDoubleBE(t)},t.prototype.writeUInt8=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeUInt8(e,t)},t.prototype.writeUInt16LE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeUInt16LE(e,t)},t.prototype.writeUInt16BE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeUInt16BE(e,t)},t.prototype.writeUInt32LE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeUInt32LE(e,t)},t.prototype.writeUInt32BE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeUInt32BE(e,t)},t.prototype.writeInt8=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeInt8(e,t)},t.prototype.writeInt16LE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeInt16LE(e,t)},t.prototype.writeInt16BE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeInt16BE(e,t)},t.prototype.writeInt32LE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeInt32LE(e,t)},t.prototype.writeInt32BE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeInt32BE(e,t)},t.prototype.writeFloatLE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeFloatLE(e,t)},t.prototype.writeFloatBE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeFloatBE(e,t)},t.prototype.writeDoubleLE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeDoubleLE(e,t)},t.prototype.writeDoubleBE=function(t,e,n){"undefined"==typeof n&&(n=!1),e+=this.offset,this.data.writeDoubleBE(e,t)},t.isEncoding=function(t){try{s.FindUtil(t)}catch(e){return!1}return!0},t.isBuffer=function(e){return e instanceof t},t.byteLength=function(t,e){"undefined"==typeof e&&(e="utf8");var n=s.FindUtil(e);return n.byteLength(t)},t.concat=function(e,n){var r;if(0===e.length||0===n)return new t(0);if(1===e.length)return e[0];
if(null==n){n=0;for(var o=0;o<e.length;o++)r=e[o],n+=r.length}for(var i=new t(n),s=0,f=0;f<e.length;f++)r=e[f],s+=r.copy(i,s);return i},t}();e.Buffer=u}),a("core/file_flag",["require","exports","./api_error"],function(t,e,n){!function(t){t[t.NOP=0]="NOP",t[t.THROW_EXCEPTION=1]="THROW_EXCEPTION",t[t.TRUNCATE_FILE=2]="TRUNCATE_FILE",t[t.CREATE_FILE=3]="CREATE_FILE"}(e.ActionType||(e.ActionType={}));var r=(e.ActionType,function(){function t(e){if(this.flagStr=e,t.validFlagStrs.indexOf(e)<0)throw new n.ApiError(9,"Invalid flag: "+e)}return t.getFileFlag=function(e){return t.flagCache.hasOwnProperty(e)?t.flagCache[e]:t.flagCache[e]=new t(e)},t.prototype.isReadable=function(){return-1!==this.flagStr.indexOf("r")||-1!==this.flagStr.indexOf("+")},t.prototype.isWriteable=function(){return-1!==this.flagStr.indexOf("w")||-1!==this.flagStr.indexOf("a")||-1!==this.flagStr.indexOf("+")},t.prototype.isTruncating=function(){return-1!==this.flagStr.indexOf("w")},t.prototype.isAppendable=function(){return-1!==this.flagStr.indexOf("a")},t.prototype.isSynchronous=function(){return-1!==this.flagStr.indexOf("s")},t.prototype.isExclusive=function(){return-1!==this.flagStr.indexOf("x")},t.prototype.pathExistsAction=function(){return this.isExclusive()?1:this.isTruncating()?2:0},t.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&"r+"!==this.flagStr?3:1},t.flagCache={},t.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"],t}());e.FileFlag=r});var u=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};a("core/node_eventemitter",["require","exports","./buffer","./api_error"],function(t,e,n,r){var o=n.Buffer,i=r.ApiError,s=(r.ErrorCode,function(){function t(t,e,n){this.data=t,this.encoding=e,this.cb=n,this.size="string"!=typeof t?t.length:o.byteLength(t,null!=e?e:void 0),"string"!=typeof this.data&&(this.data=this.data.sliceCopy())}return t.prototype.getData=function(t){return null==t?"string"==typeof this.data?new o(this.data,null!=this.encoding?this.encoding:void 0):this.data:"string"==typeof this.data?t===this.encoding?this.data:new o(this.data,null!=this.encoding?this.encoding:void 0).toString(t):this.data.toString(t)},t}()),f=function(){function t(){this._listeners={},this.maxListeners=10}return t.prototype.addListener=function(t,e){return"undefined"==typeof this._listeners[t]&&(this._listeners[t]=[]),this._listeners[t].push(e)>this.maxListeners&&process.stdout.write("Warning: Event "+t+" has more than "+this.maxListeners+" listeners.\n"),this.emit("newListener",t,e),this},t.prototype.on=function(t,e){return this.addListener(t,e)},t.prototype.once=function(t,e){var n=!1,r=function(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))};return this.addListener(t,r)},t.prototype._emitRemoveListener=function(t,e){var n;if(this._listeners.removeListener&&this._listeners.removeListener.length>0)for(n=0;n<e.length;n++)this.emit("removeListener",t,e[n])},t.prototype.removeListener=function(t,e){var n=this._listeners[t];if("undefined"!=typeof n){var r=n.indexOf(e);r>-1&&n.splice(r,1)}return this.emit("removeListener",t,e),this},t.prototype.removeAllListeners=function(t){var e,n,r;if("undefined"!=typeof t)e=this._listeners[t],this._listeners[t]=[],this._emitRemoveListener(t,e);else for(n=Object.keys(this._listeners),r=0;r<n.length;r++)this.removeAllListeners(n[r]);return this},t.prototype.setMaxListeners=function(t){this.maxListeners=t},t.prototype.listeners=function(t){return"undefined"==typeof this._listeners[t]&&(this._listeners[t]=[]),this._listeners[t].slice(0)},t.prototype.emit=function(t){for(var e=[],n=0;n<arguments.length-1;n++)e[n]=arguments[n+1];var r=this._listeners[t],o=!1;if("undefined"!=typeof r){var i;for(i=0;i<r.length;i++)o=!0,r[i].apply(this,e)}return o},t}();e.AbstractEventEmitter=f;var a=function(t){function e(e,n){t.call(this),this.writable=e,this.readable=n,this.encoding=null,this.flowing=!1,this.buffer=[],this.endEvent=null,this.ended=!1,this.drained=!0}return u(e,t),e.prototype.addListener=function(e,n){var r=t.prototype.addListener.call(this,e,n),o=this;return"data"!==e||this.flowing?"readable"===e&&this.buffer.length>0&&setTimeout(function(){o.emit("readable")},0):this.resume(),r},e.prototype._processArgs=function(t,e,n){return"string"==typeof e?new s(t,e,n):new s(t,null,e)},e.prototype._processEvents=function(){var t=0===this.buffer.length;this.drained!==t&&this.drained&&this.emit("readable"),this.flowing&&0!==this.buffer.length&&this.emit("data",this.read()),this.drained=0===this.buffer.length},e.prototype.emitEvent=function(t,e){this.emit(t,e.getData(this.encoding)),e.cb&&e.cb()},e.prototype.write=function(t,e,n){if(this.ended)throw new i(0,"Cannot write to an ended stream.");var r=this._processArgs(t,e,n);return this._push(r),this.flowing},e.prototype.end=function(t,e,n){if(this.ended)throw new i(0,"Stream is already closed.");var r=this._processArgs(t,e,n);this.ended=!0,this.endEvent=r,this._processEvents()},e.prototype.read=function(t){var e,n,r,i,f=[],a=[],u=0,c=0,h="number"!=typeof t;for(h&&(t=4294967295),c=0;c<this.buffer.length&&t>u;c++)n=this.buffer[c],f.push(n.getData()),n.cb&&a.push(n.cb),u+=n.size,e=n.cb;if(!h&&t>u)return null;if(this.buffer=this.buffer.slice(f.length),i=u>t?t:u,r=o.concat(f),u>t&&(e&&a.pop(),this._push(new s(r.slice(t),null,e))),a.length>0&&setTimeout(function(){var t;for(t=0;t<a.length;t++)a[t]()},0),this.ended&&0===this.buffer.length&&null!==this.endEvent){var p=this.endEvent,d=this;this.endEvent=null,setTimeout(function(){d.emitEvent("end",p)},0)}return 0===f.length?(this.emit("_read"),null):null===this.encoding?r.slice(0,i):r.toString(this.encoding,0,i)},e.prototype.setEncoding=function(t){this.encoding=t},e.prototype.pause=function(){this.flowing=!1},e.prototype.resume=function(){this.flowing=!0,this._processEvents()},e.prototype.pipe=function(){throw new i(0,"Unimplemented.")},e.prototype.unpipe=function(){},e.prototype.unshift=function(t){if(this.ended)throw new i(0,"Stream has ended.");this.buffer.unshift(new s(t,this.encoding)),this._processEvents()},e.prototype._push=function(t){this.buffer.push(t),this._processEvents()},e.prototype.wrap=function(){throw new i(0,"Unimplemented.")},e}(f);e.AbstractDuplexStream=a});var u=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};a("core/node_process",["require","exports","./node_eventemitter"],function(t,e,n){var r=null,o=function(t){function e(){t.call(this,!0,!0),this.isRaw=!1,this.columns=80,this.rows=120,this.isTTY=!0}return u(e,t),e.prototype.setReadMode=function(t){this.isRaw!==t&&(this.isRaw=t,this.emit("modeChange"))},e.prototype.changeColumns=function(t){t!==this.columns&&(this.columns=t,this.emit("resize"))},e.prototype.changeRows=function(t){t!==this.rows&&(this.rows=t,this.emit("resize"))},e.isatty=function(t){return t instanceof e},e}(n.AbstractDuplexStream);e.TTY=o;var i=function(){function e(){this.startTime=Date.now(),this._cwd="/",this.platform="browser",this.argv=[],this.stdout=new o,this.stderr=new o,this.stdin=new o}return e.prototype.chdir=function(e){null===r&&(r=t("./node_path").path),this._cwd=r.resolve(e)},e.prototype.cwd=function(){return this._cwd},e.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0},e}();e.Process=i,e.process=new i}),a("core/node_path",["require","exports","./node_process"],function(t,e,n){var r=n.process,o=function(){function t(){}return t.normalize=function(e){""===e&&(e=".");var n=e.charAt(0)===t.sep;e=t._removeDuplicateSeps(e);for(var r=e.split(t.sep),o=[],i=0;i<r.length;i++){var s=r[i];"."!==s&&(".."===s&&(n||!n&&o.length>0&&".."!==o[0])?o.pop():o.push(s))}if(!n&&o.length<2)switch(o.length){case 1:""===o[0]&&o.unshift(".");break;default:o.push(".")}return e=o.join(t.sep),n&&e.charAt(0)!==t.sep&&(e=t.sep+e),e},t.join=function(){for(var e=[],n=0;n<arguments.length-0;n++)e[n]=arguments[n+0];for(var r=[],o=0;o<e.length;o++){var i=e[o];if("string"!=typeof i)throw new TypeError("Invalid argument type to path.join: "+typeof i);""!==i&&r.push(i)}return t.normalize(r.join(t.sep))},t.resolve=function(){for(var e=[],n=0;n<arguments.length-0;n++)e[n]=arguments[n+0];for(var o=[],i=0;i<e.length;i++){var s=e[i];if("string"!=typeof s)throw new TypeError("Invalid argument type to path.join: "+typeof s);""!==s&&(s.charAt(0)===t.sep&&(o=[]),o.push(s))}var f=t.normalize(o.join(t.sep));if(f.length>1&&f.charAt(f.length-1)===t.sep)return f.substr(0,f.length-1);if(f.charAt(0)!==t.sep){"."!==f.charAt(0)||1!==f.length&&f.charAt(1)!==t.sep||(f=1===f.length?"":f.substr(2));var a=r.cwd();f=""!==f?this.normalize(a+("/"!==a?t.sep:"")+f):a}return f},t.relative=function(e,n){var r;e=t.resolve(e),n=t.resolve(n);var o=e.split(t.sep),i=n.split(t.sep);i.shift(),o.shift();var s=0,f=[];for(r=0;r<o.length;r++){var a=o[r];if(a!==i[r]){s=o.length-r;break}}f=i.slice(r),1===o.length&&""===o[0]&&(s=0),s>o.length&&(s=o.length);var u="";for(r=0;s>r;r++)u+="../";return u+=f.join(t.sep),u.length>1&&u.charAt(u.length-1)===t.sep&&(u=u.substr(0,u.length-1)),u},t.dirname=function(e){e=t._removeDuplicateSeps(e);var n=e.charAt(0)===t.sep,r=e.split(t.sep);return""===r.pop()&&r.length>0&&r.pop(),r.length>1?r.join(t.sep):n?t.sep:"."},t.basename=function(e,n){if("undefined"==typeof n&&(n=""),""===e)return e;e=t.normalize(e);var r=e.split(t.sep),o=r[r.length-1];if(""===o&&r.length>1)return r[r.length-2];if(n.length>0){var i=o.substr(o.length-n.length);if(i===n)return o.substr(0,o.length-n.length)}return o},t.extname=function(e){e=t.normalize(e);var n=e.split(t.sep);if(e=n.pop(),""===e&&n.length>0&&(e=n.pop()),".."===e)return"";var r=e.lastIndexOf(".");return-1===r||0===r?"":e.substr(r)},t.isAbsolute=function(e){return e.length>0&&e.charAt(0)===t.sep},t._makeLong=function(t){return t},t._removeDuplicateSeps=function(t){return t=t.replace(this._replaceRegex,this.sep)},t.sep="/",t._replaceRegex=new RegExp("//+","g"),t.delimiter=":",t}();e.path=o}),a("core/node_fs",["require","exports","./api_error","./file_flag","./buffer","./node_path"],function(t,e,n,r,o,i){function s(t,e){if("function"!=typeof t)throw new p(9,"Callback must be a function.");switch("undefined"==typeof __numWaiting&&(__numWaiting=0),__numWaiting++,e){case 1:return function(e){setImmediate(function(){return __numWaiting--,t(e)})};case 2:return function(e,n){setImmediate(function(){return __numWaiting--,t(e,n)})};case 3:return function(e,n,r){setImmediate(function(){return __numWaiting--,t(e,n,r)})};default:throw new Error("Invalid invocation of wrapCb.")}}function f(t){if("function"!=typeof t.write)throw new p(3,"Invalid file descriptor.")}function a(t,e){switch(typeof t){case"number":return t;case"string":var n=parseInt(t,8);if(0/0!==n)return n;default:return e}}function u(t){if(t.indexOf("\x00")>=0)throw new p(9,"Path must be a string without null bytes.");if(""===t)throw new p(9,"Path must not be empty.");return y.resolve(t)}function c(t,e,n,r){switch(typeof t){case"object":return{encoding:"undefined"!=typeof t.encoding?t.encoding:e,flag:"undefined"!=typeof t.flag?t.flag:n,mode:a(t.mode,r)};case"string":return{encoding:t,flag:n,mode:r};default:return{encoding:e,flag:n,mode:r}}}function h(){}var p=n.ApiError,d=(n.ErrorCode,r.FileFlag),l=o.Buffer,y=i.path,w=function(){function t(){}return t._initialize=function(e){if(!e.constructor.isAvailable())throw new p(9,"Tried to instantiate BrowserFS with an unavailable file system.");return t.root=e},t._toUnixTimestamp=function(t){if("number"==typeof t)return t;if(t instanceof Date)return t.getTime()/1e3;throw new Error("Cannot parse time: "+t)},t.getRootFS=function(){return t.root?t.root:null},t.rename=function(e,n,r){"undefined"==typeof r&&(r=h);var o=s(r,1);try{t.root.rename(u(e),u(n),o)}catch(i){o(i)}},t.renameSync=function(e,n){t.root.renameSync(u(e),u(n))},t.exists=function(e,n){"undefined"==typeof n&&(n=h);var r=s(n,1);try{return t.root.exists(u(e),r)}catch(o){return r(!1)}},t.existsSync=function(e){try{return t.root.existsSync(u(e))}catch(n){return!1}},t.stat=function(e,n){"undefined"==typeof n&&(n=h);var r=s(n,2);try{return t.root.stat(u(e),!1,r)}catch(o){return r(o,null)}},t.statSync=function(e){return t.root.statSync(u(e),!1)},t.lstat=function(e,n){"undefined"==typeof n&&(n=h);var r=s(n,2);try{return t.root.stat(u(e),!0,r)}catch(o){return r(o,null)}},t.lstatSync=function(e){return t.root.statSync(u(e),!0)},t.truncate=function(e,n,r){"undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=h);var o=0;"function"==typeof n?r=n:"number"==typeof n&&(o=n);var i=s(r,1);try{if(0>o)throw new p(9);return t.root.truncate(u(e),o,i)}catch(f){return i(f)}},t.truncateSync=function(e,n){if("undefined"==typeof n&&(n=0),0>n)throw new p(9);return t.root.truncateSync(u(e),n)},t.unlink=function(e,n){"undefined"==typeof n&&(n=h);var r=s(n,1);try{return t.root.unlink(u(e),r)}catch(o){return r(o)}},t.unlinkSync=function(e){return t.root.unlinkSync(u(e))},t.open=function(e,n,r,o){"undefined"==typeof o&&(o=h);var i=a(r,420);o="function"==typeof r?r:o;var f=s(o,2);try{return t.root.open(u(e),d.getFileFlag(n),i,f)}catch(c){return f(c,null)}},t.openSync=function(e,n,r){return"undefined"==typeof r&&(r=420),t.root.openSync(u(e),d.getFileFlag(n),r)},t.readFile=function(e,n,r){"undefined"==typeof n&&(n={}),"undefined"==typeof r&&(r=h);var o=c(n,null,"r",null);r="function"==typeof n?n:r;var i=s(r,2);try{var f=d.getFileFlag(o.flag);return f.isReadable()?t.root.readFile(u(e),o.encoding,f,i):i(new p(9,"Flag passed to readFile must allow for reading."))}catch(a){return i(a,null)}},t.readFileSync=function(e,n){"undefined"==typeof n&&(n={});var r=c(n,null,"r",null),o=d.getFileFlag(r.flag);if(!o.isReadable())throw new p(9,"Flag passed to readFile must allow for reading.");return t.root.readFileSync(u(e),r.encoding,o)},t.writeFile=function(e,n,r,o){"undefined"==typeof r&&(r={}),"undefined"==typeof o&&(o=h);var i=c(r,"utf8","w",420);o="function"==typeof r?r:o;var f=s(o,1);try{var a=d.getFileFlag(i.flag);return a.isWriteable()?t.root.writeFile(u(e),n,i.encoding,a,i.mode,f):f(new p(9,"Flag passed to writeFile must allow for writing."))}catch(l){return f(l)}},t.writeFileSync=function(e,n,r){var o=c(r,"utf8","w",420),i=d.getFileFlag(o.flag);if(!i.isWriteable())throw new p(9,"Flag passed to writeFile must allow for writing.");return t.root.writeFileSync(u(e),n,o.encoding,i,o.mode)},t.appendFile=function(e,n,r,o){"undefined"==typeof o&&(o=h);var i=c(r,"utf8","a",420);o="function"==typeof r?r:o;var f=s(o,1);try{var a=d.getFileFlag(i.flag);if(!a.isAppendable())return f(new p(9,"Flag passed to appendFile must allow for appending."));t.root.appendFile(u(e),n,i.encoding,a,i.mode,f)}catch(l){f(l)}},t.appendFileSync=function(e,n,r){var o=c(r,"utf8","a",420),i=d.getFileFlag(o.flag);if(!i.isAppendable())throw new p(9,"Flag passed to appendFile must allow for appending.");return t.root.appendFileSync(u(e),n,o.encoding,i,o.mode)},t.fstat=function(t,e){"undefined"==typeof e&&(e=h);var n=s(e,2);try{f(t),t.stat(n)}catch(r){n(r)}},t.fstatSync=function(t){return f(t),t.statSync()},t.close=function(t,e){"undefined"==typeof e&&(e=h);var n=s(e,1);try{f(t),t.close(n)}catch(r){n(r)}},t.closeSync=function(t){return f(t),t.closeSync()},t.ftruncate=function(t,e,n){"undefined"==typeof n&&(n=h);var r="number"==typeof e?e:0;n="function"==typeof e?e:n;var o=s(n,1);try{if(f(t),0>r)throw new p(9);t.truncate(r,o)}catch(i){o(i)}},t.ftruncateSync=function(t,e){return"undefined"==typeof e&&(e=0),f(t),t.truncateSync(e)},t.fsync=function(t,e){"undefined"==typeof e&&(e=h);var n=s(e,1);try{f(t),t.sync(n)}catch(r){n(r)}},t.fsyncSync=function(t){return f(t),t.syncSync()},t.fdatasync=function(t,e){"undefined"==typeof e&&(e=h);var n=s(e,1);try{f(t),t.datasync(n)}catch(r){n(r)}},t.fdatasyncSync=function(t){f(t),t.datasyncSync()},t.write=function(t,e,n,r,o,i){"undefined"==typeof i&&(i=h);var a,u,c,d=null;if("string"==typeof e){var y="utf8";switch(typeof n){case"function":i=n;break;case"number":d=n,y="string"==typeof r?r:"utf8",i="function"==typeof o?o:i;break;default:return(i="function"==typeof r?r:"function"==typeof o?o:i)(new p(9,"Invalid arguments."))}a=new l(e,y),u=0,c=a.length}else a=e,u=n,c=r,d="number"==typeof o?o:null,i="function"==typeof o?o:i;var w=s(i,3);try{f(t),null==d&&(d=t.getPos()),t.write(a,u,c,d,w)}catch(g){w(g)}},t.writeSync=function(t,e,n,r,o){var i,s,a,u=0;if("string"==typeof e){a="number"==typeof n?n:null;var c="string"==typeof r?r:"utf8";u=0,i=new l(e,c),s=i.length}else i=e,u=n,s=r,a="number"==typeof o?o:null;return f(t),null==a&&(a=t.getPos()),t.writeSync(i,u,s,a)},t.read=function(t,e,n,r,o,i){"undefined"==typeof i&&(i=h);var a,u,c,p,d;if("number"==typeof e){c=e,a=n;var y=r;i="function"==typeof o?o:i,u=0,p=new l(c),d=s(function(t,e,n){return t?i(t):void i(t,n.toString(y),e)},3)}else p=e,u=n,c=r,a=o,d=s(i,3);try{f(t),null==a&&(a=t.getPos()),t.read(p,u,c,a,d)}catch(w){d(w)}},t.readSync=function(t,e,n,r,o){var i,s,a,u,c=!1;if("number"==typeof e){a=e,u=n;var h=r;s=0,i=new l(a),c=!0}else i=e,s=n,a=r,u=o;f(t),null==u&&(u=t.getPos());var p=t.readSync(i,s,a,u);return c?[i.toString(h),p]:p},t.fchown=function(t,e,n,r){"undefined"==typeof r&&(r=h);var o=s(r,1);try{f(t),t.chown(e,n,o)}catch(i){o(i)}},t.fchownSync=function(t,e,n){return f(t),t.chownSync(e,n)},t.fchmod=function(t,e,n){"undefined"==typeof n&&(n=h);var r=s(n,1);try{e="string"==typeof e?parseInt(e,8):e,f(t),t.chmod(e,r)}catch(o){r(o)}},t.fchmodSync=function(t,e){return e="string"==typeof e?parseInt(e,8):e,f(t),t.chmodSync(e)},t.futimes=function(t,e,n,r){"undefined"==typeof r&&(r=h);var o=s(r,1);try{f(t),"number"==typeof e&&(e=new Date(1e3*e)),"number"==typeof n&&(n=new Date(1e3*n)),t.utimes(e,n,o)}catch(i){o(i)}},t.futimesSync=function(t,e,n){return f(t),"number"==typeof e&&(e=new Date(1e3*e)),"number"==typeof n&&(n=new Date(1e3*n)),t.utimesSync(e,n)},t.rmdir=function(e,n){"undefined"==typeof n&&(n=h);var r=s(n,1);try{e=u(e),t.root.rmdir(e,r)}catch(o){r(o)}},t.rmdirSync=function(e){return e=u(e),t.root.rmdirSync(e)},t.mkdir=function(e,n,r){"undefined"==typeof r&&(r=h),"function"==typeof n&&(r=n,n=511);var o=s(r,1);try{e=u(e),t.root.mkdir(e,n,o)}catch(i){o(i)}},t.mkdirSync=function(e,n){return"undefined"==typeof n&&(n=511),n="string"==typeof n?parseInt(n,8):n,e=u(e),t.root.mkdirSync(e,n)},t.readdir=function(e,n){"undefined"==typeof n&&(n=h);var r=s(n,2);try{e=u(e),t.root.readdir(e,r)}catch(o){r(o)}},t.readdirSync=function(e){return e=u(e),t.root.readdirSync(e)},t.link=function(e,n,r){"undefined"==typeof r&&(r=h);var o=s(r,1);try{e=u(e),n=u(n),t.root.link(e,n,o)}catch(i){o(i)}},t.linkSync=function(e,n){return e=u(e),n=u(n),t.root.linkSync(e,n)},t.symlink=function(e,n,r,o){"undefined"==typeof o&&(o=h);var i="string"==typeof r?r:"file";o="function"==typeof r?r:o;var f=s(o,1);try{if("file"!==i&&"dir"!==i)return f(new p(9,"Invalid type: "+i));e=u(e),n=u(n),t.root.symlink(e,n,i,f)}catch(a){f(a)}},t.symlinkSync=function(e,n,r){if(null==r)r="file";else if("file"!==r&&"dir"!==r)throw new p(9,"Invalid type: "+r);return e=u(e),n=u(n),t.root.symlinkSync(e,n,r)},t.readlink=function(e,n){"undefined"==typeof n&&(n=h);var r=s(n,2);try{e=u(e),t.root.readlink(e,r)}catch(o){r(o)}},t.readlinkSync=function(e){return e=u(e),t.root.readlinkSync(e)},t.chown=function(e,n,r,o){"undefined"==typeof o&&(o=h);var i=s(o,1);try{e=u(e),t.root.chown(e,!1,n,r,i)}catch(f){i(f)}},t.chownSync=function(e,n,r){e=u(e),t.root.chownSync(e,!1,n,r)},t.lchown=function(e,n,r,o){"undefined"==typeof o&&(o=h);var i=s(o,1);try{e=u(e),t.root.chown(e,!0,n,r,i)}catch(f){i(f)}},t.lchownSync=function(e,n,r){return e=u(e),t.root.chownSync(e,!0,n,r)},t.chmod=function(e,n,r){"undefined"==typeof r&&(r=h);var o=s(r,1);try{n="string"==typeof n?parseInt(n,8):n,e=u(e),t.root.chmod(e,!1,n,o)}catch(i){o(i)}},t.chmodSync=function(e,n){return n="string"==typeof n?parseInt(n,8):n,e=u(e),t.root.chmodSync(e,!1,n)},t.lchmod=function(e,n,r){"undefined"==typeof r&&(r=h);var o=s(r,1);try{n="string"==typeof n?parseInt(n,8):n,e=u(e),t.root.chmod(e,!0,n,o)}catch(i){o(i)}},t.lchmodSync=function(e,n){return e=u(e),n="string"==typeof n?parseInt(n,8):n,t.root.chmodSync(e,!0,n)},t.utimes=function(e,n,r,o){"undefined"==typeof o&&(o=h);var i=s(o,1);try{e=u(e),"number"==typeof n&&(n=new Date(1e3*n)),"number"==typeof r&&(r=new Date(1e3*r)),t.root.utimes(e,n,r,i)}catch(f){i(f)}},t.utimesSync=function(e,n,r){return e=u(e),"number"==typeof n&&(n=new Date(1e3*n)),"number"==typeof r&&(r=new Date(1e3*r)),t.root.utimesSync(e,n,r)},t.realpath=function(e,n,r){"undefined"==typeof r&&(r=h);var o="object"==typeof n?n:{};r="function"==typeof n?n:h;var i=s(r,2);try{e=u(e),t.root.realpath(e,o,i)}catch(f){i(f)}},t.realpathSync=function(e,n){return"undefined"==typeof n&&(n={}),e=u(e),t.root.realpathSync(e,n)},t.root=null,t}();e.fs=w}),a("core/browserfs",["require","exports","./buffer","./node_fs","./node_path","./node_process"],function(t,e,n,r,o,i){function s(t){t.Buffer=n.Buffer,t.process=i.process;var r=null!=t.require?t.require:null;t.require=function(t){var n=e.BFSRequire(t);return null==n?r.apply(null,Array.prototype.slice.call(arguments,0)):n}}function f(t,n){e.FileSystem[t]=n}function a(t){switch(t){case"fs":return r.fs;case"path":return o.path;case"buffer":return n;case"process":return i.process;default:return e.FileSystem[t]}}function u(t){return r.fs._initialize(t)}e.install=s,e.FileSystem={},e.registerFileSystem=f,e.BFSRequire=a,e.initialize=u}),a("generic/emscripten_fs",["require","exports","../core/browserfs","../core/node_fs","../core/buffer","../core/buffer_core_arraybuffer"],function(t,e,n,r,o,i){var s=o.Buffer,f=i.BufferCoreArrayBuffer,a=r.fs,u=function(){function t(t){this.fs=t}return t.prototype.open=function(t){var e=this.fs.realPath(t.node);try{FS.isFile(t.node.mode)&&(t.nfd=a.openSync(e,this.fs.flagsToPermissionString(t.flags)))}catch(n){if(!n.code)throw n;throw new FS.ErrnoError(ERRNO_CODES[n.code])}},t.prototype.close=function(t){try{FS.isFile(t.node.mode)&&t.nfd&&a.closeSync(t.nfd)}catch(e){if(!e.code)throw e;throw new FS.ErrnoError(ERRNO_CODES[e.code])}},t.prototype.read=function(t,e,n,r,o){var i,u=new f(e.buffer),c=new s(u,e.byteOffset+n,e.byteOffset+n+r);try{i=a.readSync(t.nfd,c,0,r,o)}catch(h){throw new FS.ErrnoError(ERRNO_CODES[h.code])}return i},t.prototype.write=function(t,e,n,r,o){var i,u=new f(e.buffer),c=new s(u,e.byteOffset+n,e.byteOffset+n+r);try{i=a.writeSync(t.nfd,c,0,r,o)}catch(h){throw new FS.ErrnoError(ERRNO_CODES[h.code])}return i},t.prototype.llseek=function(t,e,n){var r=e;if(1===n)r+=t.position;else if(2===n&&FS.isFile(t.node.mode))try{var o=a.fstatSync(t.nfd);r+=o.size}catch(i){throw new FS.ErrnoError(ERRNO_CODES[i.code])}if(0>r)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);return t.position=r,r},t}(),c=function(){function t(t){this.fs=t}return t.prototype.getattr=function(t){var e,n=this.fs.realPath(t);try{e=a.lstatSync(n)}catch(r){if(!r.code)throw r;throw new FS.ErrnoError(ERRNO_CODES[r.code])}return{dev:e.dev,ino:e.ino,mode:e.mode,nlink:e.nlink,uid:e.uid,gid:e.gid,rdev:e.rdev,size:e.size,atime:e.atime,mtime:e.mtime,ctime:e.ctime,blksize:e.blksize,blocks:e.blocks}},t.prototype.setattr=function(t,e){var n=this.fs.realPath(t);try{if(void 0!==e.mode&&(a.chmodSync(n,e.mode),t.mode=e.mode),void 0!==e.timestamp){var r=new Date(e.timestamp);a.utimesSync(n,r,r)}void 0!==e.size&&a.truncateSync(n,e.size)}catch(o){if(!o.code)throw o;throw new FS.ErrnoError(ERRNO_CODES[o.code])}},t.prototype.lookup=function(t,e){var n=PATH.join2(this.fs.realPath(t),e),r=this.fs.getMode(n);return this.fs.createNode(t,e,r)},t.prototype.mknod=function(t,e,n,r){var o=this.fs.createNode(t,e,n,r),i=this.fs.realPath(o);try{FS.isDir(o.mode)?a.mkdirSync(i,o.mode):a.writeFileSync(i,"",{mode:o.mode})}catch(s){if(!s.code)throw s;throw new FS.ErrnoError(ERRNO_CODES[s.code])}return o},t.prototype.rename=function(t,e,n){var r=this.fs.realPath(t),o=PATH.join2(this.fs.realPath(e),n);try{a.renameSync(r,o)}catch(i){if(!i.code)throw i;throw new FS.ErrnoError(ERRNO_CODES[i.code])}},t.prototype.unlink=function(t,e){var n=PATH.join2(this.fs.realPath(t),e);try{a.unlinkSync(n)}catch(r){if(!r.code)throw r;throw new FS.ErrnoError(ERRNO_CODES[r.code])}},t.prototype.rmdir=function(t,e){var n=PATH.join2(this.fs.realPath(t),e);try{a.rmdirSync(n)}catch(r){if(!r.code)throw r;throw new FS.ErrnoError(ERRNO_CODES[r.code])}},t.prototype.readdir=function(t){var e=this.fs.realPath(t);try{return a.readdirSync(e)}catch(n){if(!n.code)throw n;throw new FS.ErrnoError(ERRNO_CODES[n.code])}},t.prototype.symlink=function(t,e,n){var r=PATH.join2(this.fs.realPath(t),e);try{a.symlinkSync(n,r)}catch(o){if(!o.code)throw o;throw new FS.ErrnoError(ERRNO_CODES[o.code])}},t.prototype.readlink=function(t){var e=this.fs.realPath(t);try{return a.readlinkSync(e)}catch(n){if(!n.code)throw n;throw new FS.ErrnoError(ERRNO_CODES[n.code])}},t}(),h=function(){function t(){if(this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},this.node_ops=new c(this),this.stream_ops=new u(this),"undefined"==typeof n)throw new Error("BrowserFS is not loaded. Please load it before this library.")}return t.prototype.mount=function(t){return this.createNode(null,"/",this.getMode(t.opts.root),0)},t.prototype.createNode=function(t,e,n){if(!FS.isDir(n)&&!FS.isFile(n)&&!FS.isLink(n))throw new FS.ErrnoError(ERRNO_CODES.EINVAL);var r=FS.createNode(t,e,n);return r.node_ops=this.node_ops,r.stream_ops=this.stream_ops,r},t.prototype.getMode=function(t){var e;try{e=a.lstatSync(t)}catch(n){if(!n.code)throw n;throw new FS.ErrnoError(ERRNO_CODES[n.code])}return e.mode},t.prototype.realPath=function(t){for(var e=[];t.parent!==t;)e.push(t.name),t=t.parent;return e.push(t.mount.opts.root),e.reverse(),PATH.join.apply(null,e)},t.prototype.flagsToPermissionString=function(t){return t in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[t]:t},t}();e.BFSEmscriptenFS=h,n.EmscriptenFS=h});var u=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};a("core/file_system",["require","exports","./api_error","./file_flag","./node_path","./buffer"],function(t,e,n,r,o,i){var s=n.ApiError,f=(n.ErrorCode,o.path),a=i.Buffer,c=(r.ActionType,function(){function t(){}return t.prototype.supportsLinks=function(){return!1},t.prototype.diskSpace=function(t,e){e(0,0)},t.prototype.openFile=function(){throw new s(14)},t.prototype.createFile=function(){throw new s(14)},t.prototype.open=function(t,e,n,r){var o=this,i=function(i,a){if(i)switch(e.pathNotExistsAction()){case 3:return o.stat(f.dirname(t),!1,function(i,a){i?r(i):a.isDirectory()?o.createFile(t,e,n,r):r(new s(7,f.dirname(t)+" is not a directory."))});case 1:return r(new s(1,""+t+" doesn't exist."));default:return r(new s(9,"Invalid FileFlag object."))}else{if(a.isDirectory())return r(new s(8,t+" is a directory."));switch(e.pathExistsAction()){case 1:return r(new s(6,t+" already exists."));case 2:return o.openFile(t,e,function(t,e){t?r(t):e.truncate(0,function(){e.sync(function(){r(null,e)})})});case 0:return o.openFile(t,e,r);default:return r(new s(9,"Invalid FileFlag object."))}}};this.stat(t,!1,i)},t.prototype.rename=function(t,e,n){n(new s(14))},t.prototype.renameSync=function(){throw new s(14)},t.prototype.stat=function(t,e,n){n(new s(14))},t.prototype.statSync=function(){throw new s(14)},t.prototype.openFileSync=function(){throw new s(14)},t.prototype.createFileSync=function(){throw new s(14)},t.prototype.openSync=function(t,e,n){var r;try{r=this.statSync(t,!1)}catch(o){switch(e.pathNotExistsAction()){case 3:var i=this.statSync(f.dirname(t),!1);if(!i.isDirectory())throw new s(7,f.dirname(t)+" is not a directory.");return this.createFileSync(t,e,n);case 1:throw new s(1,""+t+" doesn't exist.");default:throw new s(9,"Invalid FileFlag object.")}}if(r.isDirectory())throw new s(8,t+" is a directory.");switch(e.pathExistsAction()){case 1:throw new s(6,t+" already exists.");case 2:return this.unlinkSync(t),this.createFileSync(t,e,r.mode);case 0:return this.openFileSync(t,e);default:throw new s(9,"Invalid FileFlag object.")}},t.prototype.unlink=function(t,e){e(new s(14))},t.prototype.unlinkSync=function(){throw new s(14)},t.prototype.rmdir=function(t,e){e(new s(14))},t.prototype.rmdirSync=function(){throw new s(14)},t.prototype.mkdir=function(t,e,n){n(new s(14))},t.prototype.mkdirSync=function(){throw new s(14)},t.prototype.readdir=function(t,e){e(new s(14))},t.prototype.readdirSync=function(){throw new s(14)},t.prototype.exists=function(t,e){this.stat(t,null,function(t){e(null==t)})},t.prototype.existsSync=function(t){try{return this.statSync(t,!0),!0}catch(e){return!1}},t.prototype.realpath=function(t,e,n){if(this.supportsLinks())for(var r=t.split(f.sep),o=0;o<r.length;o++){var i=r.slice(0,o+1);r[o]=f.join.apply(null,i)}else this.exists(t,function(e){e?n(null,t):n(new s(1,"File "+t+" not found."))})},t.prototype.realpathSync=function(t){if(!this.supportsLinks()){if(this.existsSync(t))return t;throw new s(1,"File "+t+" not found.")}for(var e=t.split(f.sep),n=0;n<e.length;n++){var r=e.slice(0,n+1);e[n]=f.join.apply(null,r)}},t.prototype.truncate=function(t,e,n){this.open(t,r.FileFlag.getFileFlag("r+"),420,function(t,r){return t?n(t):void r.truncate(e,function(t){r.close(function(e){n(t||e)})})})},t.prototype.truncateSync=function(t,e){var n=this.openSync(t,r.FileFlag.getFileFlag("r+"),420);try{n.truncateSync(e)}catch(o){throw o}finally{n.closeSync()}},t.prototype.readFile=function(t,e,n,r){var o=r;this.open(t,n,420,function(t,n){return t?r(t):(r=function(t,e){n.close(function(n){return null==t&&(t=n),o(t,e)})},void n.stat(function(t,o){if(null!=t)return r(t);var i=new a(o.size);n.read(i,0,o.size,0,function(t){if(null!=t)return r(t);if(null===e)return r(t,i);try{r(null,i.toString(e))}catch(n){r(n)}})}))})},t.prototype.readFileSync=function(t,e,n){var r=this.openSync(t,n,420);try{var o=r.statSync(),i=new a(o.size);return r.readSync(i,0,o.size,0),r.closeSync(),null===e?i:i.toString(e)}finally{r.closeSync()}},t.prototype.writeFile=function(t,e,n,r,o,i){var s=i;this.open(t,r,420,function(t,r){if(null!=t)return i(t);i=function(t){r.close(function(e){s(null!=t?t:e)})};try{"string"==typeof e&&(e=new a(e,n))}catch(o){return i(o)}r.write(e,0,e.length,0,i)})},t.prototype.writeFileSync=function(t,e,n,r,o){var i=this.openSync(t,r,o);try{"string"==typeof e&&(e=new a(e,n)),i.writeSync(e,0,e.length,0)}finally{i.closeSync()}},t.prototype.appendFile=function(t,e,n,r,o,i){var s=i;this.open(t,r,o,function(t,r){return null!=t?i(t):(i=function(t){r.close(function(e){s(null!=t?t:e)})},"string"==typeof e&&(e=new a(e,n)),void r.write(e,0,e.length,null,i))})},t.prototype.appendFileSync=function(t,e,n,r,o){var i=this.openSync(t,r,o);try{"string"==typeof e&&(e=new a(e,n)),i.writeSync(e,0,e.length,null)}finally{i.closeSync()}},t.prototype.chmod=function(t,e,n,r){r(new s(14))},t.prototype.chmodSync=function(){throw new s(14)},t.prototype.chown=function(t,e,n,r,o){o(new s(14))},t.prototype.chownSync=function(){throw new s(14)},t.prototype.utimes=function(t,e,n,r){r(new s(14))},t.prototype.utimesSync=function(){throw new s(14)},t.prototype.link=function(t,e,n){n(new s(14))},t.prototype.linkSync=function(){throw new s(14)},t.prototype.symlink=function(t,e,n,r){r(new s(14))},t.prototype.symlinkSync=function(){throw new s(14)},t.prototype.readlink=function(t,e){e(new s(14))},t.prototype.readlinkSync=function(){throw new s(14)},t}());e.BaseFileSystem=c;var h=function(t){function e(){t.apply(this,arguments)}return u(e,t),e.prototype.supportsSynch=function(){return!0},e.prototype.rename=function(t,e,n){try{this.renameSync(t,e),n()}catch(r){n(r)}},e.prototype.stat=function(t,e,n){try{n(null,this.statSync(t,e))}catch(r){n(r)
}},e.prototype.open=function(t,e,n,r){try{r(null,this.openSync(t,e,n))}catch(o){r(o)}},e.prototype.unlink=function(t,e){try{this.unlinkSync(t),e()}catch(n){e(n)}},e.prototype.rmdir=function(t,e){try{this.rmdirSync(t),e()}catch(n){e(n)}},e.prototype.mkdir=function(t,e,n){try{this.mkdirSync(t,e),n()}catch(r){n(r)}},e.prototype.readdir=function(t,e){try{e(null,this.readdirSync(t))}catch(n){e(n)}},e.prototype.chmod=function(t,e,n,r){try{this.chmodSync(t,e,n),r()}catch(o){r(o)}},e.prototype.chown=function(t,e,n,r,o){try{this.chownSync(t,e,n,r),o()}catch(i){o(i)}},e.prototype.utimes=function(t,e,n,r){try{this.utimesSync(t,e,n),r()}catch(o){r(o)}},e.prototype.link=function(t,e,n){try{this.linkSync(t,e),n()}catch(r){n(r)}},e.prototype.symlink=function(t,e,n,r){try{this.symlinkSync(t,e,n),r()}catch(o){r(o)}},e.prototype.readlink=function(t,e){try{e(null,this.readlinkSync(t))}catch(n){e(n)}},e}(c);e.SynchronousFileSystem=h}),a("core/node_fs_stats",["require","exports"],function(t,e){!function(t){t[t.FILE=32768]="FILE",t[t.DIRECTORY=16384]="DIRECTORY",t[t.SYMLINK=40960]="SYMLINK"}(e.FileType||(e.FileType={}));var n=(e.FileType,function(){function t(t,e,n,r,o,i){if("undefined"==typeof r&&(r=new Date),"undefined"==typeof o&&(o=new Date),"undefined"==typeof i&&(i=new Date),this.size=e,this.mode=n,this.atime=r,this.mtime=o,this.ctime=i,this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0,null==this.mode)switch(t){case 32768:this.mode=420;break;case 16384:default:this.mode=511}this.blocks=Math.ceil(e/512),this.mode<4096&&(this.mode|=t)}return t.prototype.clone=function(){return new t(61440&this.mode,this.size,4095&this.mode,this.atime,this.mtime,this.ctime)},t.prototype.isFile=function(){return 32768===(61440&this.mode)},t.prototype.isDirectory=function(){return 16384===(61440&this.mode)},t.prototype.isSymbolicLink=function(){return 40960===(61440&this.mode)},t.prototype.chmod=function(t){this.mode=61440&this.mode|t},t.prototype.isSocket=function(){return!1},t.prototype.isBlockDevice=function(){return!1},t.prototype.isCharacterDevice=function(){return!1},t.prototype.isFIFO=function(){return!1},t}());e.Stats=n}),a("generic/inode",["require","exports","../core/node_fs_stats","../core/buffer"],function(t,e,n,r){var o=function(){function t(t,e,n,r,o,i){this.id=t,this.size=e,this.mode=n,this.atime=r,this.mtime=o,this.ctime=i}return t.prototype.toStats=function(){return new n.Stats(16384===(61440&this.mode)?16384:32768,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))},t.prototype.getSize=function(){return 30+this.id.length},t.prototype.toBuffer=function(t){return"undefined"==typeof t&&(t=new r.Buffer(this.getSize())),t.writeUInt32LE(this.size,0),t.writeUInt16LE(this.mode,4),t.writeDoubleLE(this.atime,6),t.writeDoubleLE(this.mtime,14),t.writeDoubleLE(this.ctime,22),t.write(this.id,30,this.id.length,"ascii"),t},t.prototype.update=function(t){var e=!1;this.size!==t.size&&(this.size=t.size,e=!0),this.mode!==t.mode&&(this.mode=t.mode,e=!0);var n=t.atime.getTime();this.atime!==n&&(this.atime=n,e=!0);var r=t.mtime.getTime();this.mtime!==r&&(this.mtime=r,e=!0);var o=t.ctime.getTime();return this.ctime!==o&&(this.ctime=o,e=!0),e},t.fromBuffer=function(e){if(void 0===e)throw new Error("NO");return new t(e.toString("ascii",30),e.readUInt32LE(0),e.readUInt16LE(4),e.readDoubleLE(6),e.readDoubleLE(14),e.readDoubleLE(22))},t.prototype.isFile=function(){return 32768===(61440&this.mode)},t.prototype.isDirectory=function(){return 16384===(61440&this.mode)},t}();return o}),a("core/file",["require","exports","./api_error"],function(t,e,n){var r=n.ApiError,o=(n.ErrorCode,function(){function t(){}return t.prototype.sync=function(t){t(new r(14))},t.prototype.syncSync=function(){throw new r(14)},t.prototype.datasync=function(t){this.sync(t)},t.prototype.datasyncSync=function(){return this.syncSync()},t.prototype.chown=function(t,e,n){n(new r(14))},t.prototype.chownSync=function(){throw new r(14)},t.prototype.chmod=function(t,e){e(new r(14))},t.prototype.chmodSync=function(){throw new r(14)},t.prototype.utimes=function(t,e,n){n(new r(14))},t.prototype.utimesSync=function(){throw new r(14)},t}());e.BaseFile=o});var u=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};a("generic/preload_file",["require","exports","../core/file","../core/buffer","../core/api_error","../core/node_fs"],function(t,e,n,r,o,i){var s=o.ApiError,f=(o.ErrorCode,i.fs),a=r.Buffer,c=function(t){function e(e,n,r,o,i){if(t.call(this),this._pos=0,this._fs=e,this._path=n,this._flag=r,this._stat=o,this._buffer=null!=i?i:new a(0),this._stat.size!==this._buffer.length)throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return u(e,t),e.prototype.getPath=function(){return this._path},e.prototype.getPos=function(){return this._flag.isAppendable()?this._stat.size:this._pos},e.prototype.advancePos=function(t){return this._pos+=t},e.prototype.setPos=function(t){return this._pos=t},e.prototype.sync=function(t){try{this.syncSync(),t()}catch(e){t(e)}},e.prototype.syncSync=function(){throw new s(14)},e.prototype.close=function(t){try{this.closeSync(),t()}catch(e){t(e)}},e.prototype.closeSync=function(){throw new s(14)},e.prototype.stat=function(t){try{t(null,this._stat.clone())}catch(e){t(e)}},e.prototype.statSync=function(){return this._stat.clone()},e.prototype.truncate=function(t,e){try{this.truncateSync(t),this._flag.isSynchronous()&&!f.getRootFS().supportsSynch()&&this.sync(e),e()}catch(n){return e(n)}},e.prototype.truncateSync=function(t){if(!this._flag.isWriteable())throw new s(0,"File not opened with a writeable mode.");if(this._stat.mtime=new Date,t>this._buffer.length){var e=new a(t-this._buffer.length);return e.fill(0),this.writeSync(e,0,e.length,this._buffer.length),void(this._flag.isSynchronous()&&f.getRootFS().supportsSynch()&&this.syncSync())}this._stat.size=t;var n=new a(t);this._buffer.copy(n,0,0,t),this._buffer=n,this._flag.isSynchronous()&&f.getRootFS().supportsSynch()&&this.syncSync()},e.prototype.write=function(t,e,n,r,o){try{o(null,this.writeSync(t,e,n,r),t)}catch(i){o(i)}},e.prototype.writeSync=function(t,e,n,r){if(null==r&&(r=this.getPos()),!this._flag.isWriteable())throw new s(0,"File not opened with a writeable mode.");var o=r+n;if(o>this._stat.size&&(this._stat.size=o,o>this._buffer.length)){var i=new a(o);this._buffer.copy(i),this._buffer=i}var f=t.copy(this._buffer,r,e,e+n);return this._stat.mtime=new Date,this._flag.isSynchronous()?(this.syncSync(),f):(this.setPos(r+f),f)},e.prototype.read=function(t,e,n,r,o){try{o(null,this.readSync(t,e,n,r),t)}catch(i){o(i)}},e.prototype.readSync=function(t,e,n,r){if(!this._flag.isReadable())throw new s(0,"File not opened with a readable mode.");null==r&&(r=this.getPos());var o=r+n;o>this._stat.size&&(n=this._stat.size-r);var i=this._buffer.copy(t,e,r,r+n);return this._stat.atime=new Date,this._pos=r+n,i},e.prototype.chmod=function(t,e){try{this.chmodSync(t),e()}catch(n){e(n)}},e.prototype.chmodSync=function(t){if(!this._fs.supportsProps())throw new s(14);this._stat.chmod(t),this.syncSync()},e}(n.BaseFile);e.PreloadFile=c;var h=function(t){function e(e,n,r,o,i){t.call(this,e,n,r,o,i)}return u(e,t),e.prototype.sync=function(t){t()},e.prototype.syncSync=function(){},e.prototype.close=function(t){t()},e.prototype.closeSync=function(){},e}(c);e.NoSyncFile=h});var u=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};a("generic/key_value_filesystem",["require","exports","../core/file_system","../core/api_error","../core/node_fs_stats","../core/node_path","../generic/inode","../core/buffer","../generic/preload_file"],function(t,e,n,r,o,i,s,f,a){function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})}function h(t,e){return t?(e(t),!1):!0}function p(t,e,n){return t?(e.abort(function(){n(t)}),!1):!0}var d="/",l=i.path,y=r.ApiError,w=f.Buffer,g=function(){function t(t){this.store=t,this.originalData={},this.modifiedKeys=[]}return t.prototype.stashOldValue=function(t,e){this.originalData.hasOwnProperty(t)||(this.originalData[t]=e)},t.prototype.markModified=function(t){-1===this.modifiedKeys.indexOf(t)&&(this.modifiedKeys.push(t),this.originalData.hasOwnProperty(t)||(this.originalData[t]=this.store.get(t)))},t.prototype.get=function(t){var e=this.store.get(t);return this.stashOldValue(t,e),e},t.prototype.put=function(t,e,n){return this.markModified(t),this.store.put(t,e,n)},t.prototype.delete=function(t){this.markModified(t),this.store.delete(t)},t.prototype.commit=function(){},t.prototype.abort=function(){var t,e,n;for(t=0;t<this.modifiedKeys.length;t++)e=this.modifiedKeys[t],n=this.originalData[e],null===n?this.store.delete(e):this.store.put(e,n,!0)},t}();e.SimpleSyncRWTransaction=g;var m=function(t){function e(e,n,r,o,i){t.call(this,e,n,r,o,i)}return u(e,t),e.prototype.syncSync=function(){this._fs._syncSync(this._path,this._buffer,this._stat)},e.prototype.closeSync=function(){this.syncSync()},e}(a.PreloadFile);e.SyncKeyValueFile=m;var v=function(t){function e(e){t.call(this),this.store=e.store,this.makeRootDirectory()}return u(e,t),e.isAvailable=function(){return!0},e.prototype.getName=function(){return this.store.name()},e.prototype.isReadOnly=function(){return!1},e.prototype.supportsSymlinks=function(){return!1},e.prototype.supportsProps=function(){return!1},e.prototype.supportsSynch=function(){return!0},e.prototype.makeRootDirectory=function(){var t=this.store.beginTransaction("readwrite");if(void 0===t.get(d)){var e=(new Date).getTime(),n=new s(c(),4096,16895,e,e,e);t.put(n.id,new w("{}"),!1),t.put(d,n.toBuffer(),!1),t.commit()}},e.prototype._findINode=function(t,e,n){var r=this,o=function(o){var i=r.getDirListing(t,e,o);if(i[n])return i[n];throw y.ENOENT(l.resolve(e,n))};return"/"===e?""===n?d:o(this.getINode(t,e,d)):o(this.getINode(t,e+l.sep+n,this._findINode(t,l.dirname(e),l.basename(e))))},e.prototype.findINode=function(t,e){return this.getINode(t,e,this._findINode(t,l.dirname(e),l.basename(e)))},e.prototype.getINode=function(t,e,n){var r=t.get(n);if(void 0===r)throw y.ENOENT(e);return s.fromBuffer(r)},e.prototype.getDirListing=function(t,e,n){if(!n.isDirectory())throw y.ENOTDIR(e);var r=t.get(n.id);if(void 0===r)throw y.ENOENT(e);return JSON.parse(r.toString())},e.prototype.addNewNode=function(t,e){for(var n,r=0;5>r;)try{return n=c(),t.put(n,e,!1),n}catch(o){}throw new y(2,"Unable to commit data to key-value store.")},e.prototype.commitNewFile=function(t,e,n,r,o){var i=l.dirname(e),f=l.basename(e),a=this.findINode(t,i),u=this.getDirListing(t,i,a),c=(new Date).getTime();if("/"===e)throw y.EEXIST(e);if(u[f])throw y.EEXIST(e);try{var h=this.addNewNode(t,o),p=new s(h,o.length,r|n,c,c,c),d=this.addNewNode(t,p.toBuffer());u[f]=d,t.put(a.id,new w(JSON.stringify(u)),!0)}catch(g){throw t.abort(),g}return t.commit(),p},e.prototype.empty=function(){this.store.clear(),this.makeRootDirectory()},e.prototype.renameSync=function(t,e){var n=this.store.beginTransaction("readwrite"),r=l.dirname(t),o=l.basename(t),i=l.dirname(e),s=l.basename(e),f=this.findINode(n,r),a=this.getDirListing(n,r,f);if(!a[o])throw y.ENOENT(t);var u=a[o];if(delete a[o],0===(i+"/").indexOf(t+"/"))throw new y(5,r);var c,h;if(i===r?(c=f,h=a):(c=this.findINode(n,i),h=this.getDirListing(n,i,c)),h[s]){var p=this.getINode(n,e,h[s]);if(!p.isFile())throw y.EPERM(e);try{n.delete(p.id),n.delete(h[s])}catch(d){throw n.abort(),d}}h[s]=u;try{n.put(f.id,new w(JSON.stringify(a)),!0),n.put(c.id,new w(JSON.stringify(h)),!0)}catch(d){throw n.abort(),d}n.commit()},e.prototype.statSync=function(t){return this.findINode(this.store.beginTransaction("readonly"),t).toStats()},e.prototype.createFileSync=function(t,e,n){var r=this.store.beginTransaction("readwrite"),o=new w(0),i=this.commitNewFile(r,t,32768,n,o);return new m(this,t,e,i.toStats(),o)},e.prototype.openFileSync=function(t,e){var n=this.store.beginTransaction("readonly"),r=this.findINode(n,t),o=n.get(r.id);if(void 0===o)throw y.ENOENT(t);return new m(this,t,e,r.toStats(),o)},e.prototype.removeEntry=function(t,e){var n=this.store.beginTransaction("readwrite"),r=l.dirname(t),o=this.findINode(n,r),i=this.getDirListing(n,r,o),s=l.basename(t);if(!i[s])throw y.ENOENT(t);var f=i[s];delete i[s];var a=this.getINode(n,t,f);if(!e&&a.isDirectory())throw y.EISDIR(t);if(e&&!a.isDirectory())throw y.ENOTDIR(t);try{n.delete(a.id),n.delete(f),n.put(o.id,new w(JSON.stringify(i)),!0)}catch(u){throw n.abort(),u}n.commit()},e.prototype.unlinkSync=function(t){this.removeEntry(t,!1)},e.prototype.rmdirSync=function(t){this.removeEntry(t,!0)},e.prototype.mkdirSync=function(t,e){var n=this.store.beginTransaction("readwrite"),r=new w("{}");this.commitNewFile(n,t,16384,e,r)},e.prototype.readdirSync=function(t){var e=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(e,t,this.findINode(e,t)))},e.prototype._syncSync=function(t,e,n){var r=this.store.beginTransaction("readwrite"),o=this._findINode(r,l.dirname(t),l.basename(t)),i=this.getINode(r,t,o),s=i.update(n);try{r.put(i.id,e,!0),s&&r.put(o,i.toBuffer(),!0)}catch(f){throw r.abort(),f}r.commit()},e}(n.SynchronousFileSystem);e.SyncKeyValueFileSystem=v;var E=function(t){function e(e,n,r,o,i){t.call(this,e,n,r,o,i)}return u(e,t),e.prototype.sync=function(t){this._fs._sync(this._path,this._buffer,this._stat,t)},e.prototype.close=function(t){this.sync(t)},e}(a.PreloadFile);e.AsyncKeyValueFile=E;var b=function(t){function e(){t.apply(this,arguments)}return u(e,t),e.prototype.init=function(t,e){this.store=t,this.makeRootDirectory(e)},e.isAvailable=function(){return!0},e.prototype.getName=function(){return this.store.name()},e.prototype.isReadOnly=function(){return!1},e.prototype.supportsSymlinks=function(){return!1},e.prototype.supportsProps=function(){return!1},e.prototype.supportsSynch=function(){return!1},e.prototype.makeRootDirectory=function(t){var e=this.store.beginTransaction("readwrite");e.get(d,function(n,r){if(n||void 0===r){var o=(new Date).getTime(),i=new s(c(),4096,16895,o,o,o);e.put(i.id,new w("{}"),!1,function(n){p(n,e,t)&&e.put(d,i.toBuffer(),!1,function(n){n?e.abort(function(){t(n)}):e.commit(t)})})}else e.commit(t)})},e.prototype._findINode=function(t,e,n,r){var o=this,i=function(t,o,i){t?r(t):i[n]?r(null,i[n]):r(y.ENOENT(l.resolve(e,n)))};"/"===e?""===n?r(null,d):this.getINode(t,e,d,function(n,s){h(n,r)&&o.getDirListing(t,e,s,function(t,e){i(t,s,e)})}):this.findINodeAndDirListing(t,e,i)},e.prototype.findINode=function(t,e,n){var r=this;this._findINode(t,l.dirname(e),l.basename(e),function(o,i){h(o,n)&&r.getINode(t,e,i,n)})},e.prototype.getINode=function(t,e,n,r){t.get(n,function(t,n){h(t,r)&&(void 0===n?r(y.ENOENT(e)):r(null,s.fromBuffer(n)))})},e.prototype.getDirListing=function(t,e,n,r){n.isDirectory()?t.get(n.id,function(t,n){if(h(t,r))try{r(null,JSON.parse(n.toString()))}catch(t){r(y.ENOENT(e))}}):r(y.ENOTDIR(e))},e.prototype.findINodeAndDirListing=function(t,e,n){var r=this;this.findINode(t,e,function(o,i){h(o,n)&&r.getDirListing(t,e,i,function(t,e){h(t,n)&&n(null,i,e)})})},e.prototype.addNewNode=function(t,e,n){var r,o=0,i=function(){5===++o?n(new y(2,"Unable to commit data to key-value store.")):(r=c(),t.put(r,e,!1,function(t,e){t||!e?i():n(null,r)}))};i()},e.prototype.commitNewFile=function(t,e,n,r,o,i){var f=this,a=l.dirname(e),u=l.basename(e),c=(new Date).getTime();return"/"===e?i(y.EEXIST(e)):void this.findINodeAndDirListing(t,a,function(a,h,d){p(a,t,i)&&(d[u]?t.abort(function(){i(y.EEXIST(e))}):f.addNewNode(t,o,function(e,a){if(p(e,t,i)){var l=new s(a,o.length,r|n,c,c,c);f.addNewNode(t,l.toBuffer(),function(e,n){p(e,t,i)&&(d[u]=n,t.put(h.id,new w(JSON.stringify(d)),!0,function(e){p(e,t,i)&&t.commit(function(e){p(e,t,i)&&i(null,l)})}))})}}))})},e.prototype.empty=function(t){var e=this;this.store.clear(function(n){h(n,t)&&e.makeRootDirectory(t)})},e.prototype.rename=function(t,e,n){var r=this,o=this.store.beginTransaction("readwrite"),i=l.dirname(t),s=l.basename(t),f=l.dirname(e),a=l.basename(e),u={},c={},h=!1;if(0===(f+"/").indexOf(t+"/"))return n(new y(5,i));var d=function(){if(!h&&c.hasOwnProperty(i)&&c.hasOwnProperty(f)){var d=c[i],l=u[i],g=c[f],m=u[f];if(d[s]){var v=d[s];delete d[s];var E=function(){g[a]=v,o.put(l.id,new w(JSON.stringify(d)),!0,function(t){p(t,o,n)&&(i===f?o.commit(n):o.put(m.id,new w(JSON.stringify(g)),!0,function(t){p(t,o,n)&&o.commit(n)}))})};g[a]?r.getINode(o,e,g[a],function(t,r){p(t,o,n)&&(r.isFile()?o.delete(r.id,function(t){p(t,o,n)&&o.delete(g[a],function(t){p(t,o,n)&&E()})}):o.abort(function(){n(y.EPERM(e))}))}):E()}else n(y.ENOENT(t))}},g=function(t){r.findINodeAndDirListing(o,t,function(e,r,i){e?h||(h=!0,o.abort(function(){n(e)})):(u[t]=r,c[t]=i,d())})};g(i),i!==f&&g(f)},e.prototype.stat=function(t,e,n){var r=this.store.beginTransaction("readonly");this.findINode(r,t,function(t,e){h(t,n)&&n(null,e.toStats())})},e.prototype.createFile=function(t,e,n,r){var o=this,i=this.store.beginTransaction("readwrite"),s=new w(0);this.commitNewFile(i,t,32768,n,s,function(n,i){h(n,r)&&r(null,new E(o,t,e,i.toStats(),s))})},e.prototype.openFile=function(t,e,n){var r=this,o=this.store.beginTransaction("readonly");this.findINode(o,t,function(i,s){h(i,n)&&o.get(s.id,function(o,i){h(o,n)&&(void 0===i?n(y.ENOENT(t)):n(null,new E(r,t,e,s.toStats(),i)))})})},e.prototype.removeEntry=function(t,e,n){var r=this,o=this.store.beginTransaction("readwrite"),i=l.dirname(t),s=l.basename(t);this.findINodeAndDirListing(o,i,function(i,f,a){if(p(i,o,n))if(a[s]){var u=a[s];delete a[s],r.getINode(o,t,u,function(r,i){p(r,o,n)&&(!e&&i.isDirectory()?o.abort(function(){n(y.EISDIR(t))}):e&&!i.isDirectory()?o.abort(function(){n(y.ENOTDIR(t))}):o.delete(i.id,function(t){p(t,o,n)&&o.delete(u,function(t){p(t,o,n)&&o.put(f.id,new w(JSON.stringify(a)),!0,function(t){p(t,o,n)&&o.commit(n)})})}))})}else o.abort(function(){n(y.ENOENT(t))})})},e.prototype.unlink=function(t,e){this.removeEntry(t,!1,e)},e.prototype.rmdir=function(t,e){this.removeEntry(t,!0,e)},e.prototype.mkdir=function(t,e,n){var r=this.store.beginTransaction("readwrite"),o=new w("{}");this.commitNewFile(r,t,16384,e,o,n)},e.prototype.readdir=function(t,e){var n=this,r=this.store.beginTransaction("readonly");this.findINode(r,t,function(o,i){h(o,e)&&n.getDirListing(r,t,i,function(t,n){h(t,e)&&e(null,Object.keys(n))})})},e.prototype._sync=function(t,e,n,r){var o=this,i=this.store.beginTransaction("readwrite");this._findINode(i,l.dirname(t),l.basename(t),function(s,f){p(s,i,r)&&o.getINode(i,t,f,function(t,o){if(p(t,i,r)){var s=o.update(n);i.put(o.id,e,!0,function(t){p(t,i,r)&&(s?i.put(f,o.toBuffer(),!0,function(t){p(t,i,r)&&i.commit(r)}):i.commit(r))})}})})},e}(n.BaseFileSystem);e.AsyncKeyValueFileSystem=b}),a("core/global",["require","exports"],function(){var t;return t="undefined"!=typeof window?window:"undefined"!=typeof self?self:global});var u=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n};a("backend/IndexedDB",["require","exports","../core/buffer","../core/browserfs","../generic/key_value_filesystem","../core/api_error","../core/buffer_core_arraybuffer","../core/global"],function(t,e,n,r,o,i,s,f){function a(t,e){switch("undefined"==typeof e&&(e=t.toString()),t.name){case"NotFoundError":return new d(1,e);case"QuotaExceededError":return new d(11,e);default:return new d(2,e)}}function c(t,e,n){return"undefined"==typeof e&&(e=2),"undefined"==typeof n&&(n=null),function(r){r.preventDefault(),t(new d(e,n))}}function h(t){var e=t.getBufferCore();e instanceof s.BufferCoreArrayBuffer||(n=new p(this._buffer.length),this._buffer.copy(n),e=n.getBufferCore());var r=e.getDataView();return r.buffer}var p=n.Buffer,d=i.ApiError,l=(i.ErrorCode,f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB),y=function(){function t(t,e){this.tx=t,this.store=e}return t.prototype.get=function(t,e){try{var n=this.store.get(t);n.onerror=c(e),n.onsuccess=function(t){var n=t.target.result;void 0===n?e(null,n):e(null,new p(n))}}catch(r){e(a(r))}},t}();e.IndexedDBROTransaction=y;var w=function(t){function e(e,n){t.call(this,e,n)}return u(e,t),e.prototype.put=function(t,e,n,r){try{var o,i=h(e);o=n?this.store.put(i,t):this.store.add(i,t),o.onerror=c(r),o.onsuccess=function(){r(null,!0)}}catch(s){r(a(s))}},e.prototype.delete=function(t,e){try{var n=this.store.delete(t);n.onerror=c(e),n.onsuccess=function(){e()}}catch(r){e(a(r))}},e.prototype.commit=function(t){setTimeout(t,0)},e.prototype.abort=function(t){var e;try{this.tx.abort()}catch(n){e=a(n)}finally{t(e)}},e}(y);e.IndexedDBRWTransaction=w;var g=function(){function t(t,e){"undefined"==typeof e&&(e="browserfs");var n=this;this.storeName=e;var r=l.open(this.storeName,1);r.onupgradeneeded=function(t){var e=t.target.result;e.objectStoreNames.contains(n.storeName)&&e.deleteObjectStore(n.storeName),e.createObjectStore(n.storeName)},r.onsuccess=function(e){n.db=e.target.result,t(null,n)},r.onerror=c(t,4)}return t.prototype.name=function(){return"IndexedDB - "+this.storeName},t.prototype.clear=function(t){try{var e=this.db.transaction(this.storeName,"readwrite"),n=e.objectStore(this.storeName),r=n.clear();r.onsuccess=function(){setTimeout(t,0)},r.onerror=c(t)}catch(o){t(a(o))}},t.prototype.beginTransaction=function(t){"undefined"==typeof t&&(t="readonly");var e=this.db.transaction(this.storeName,t),n=e.objectStore(this.storeName);if("readwrite"===t)return new w(e,n);if("readonly"===t)return new y(e,n);throw new d(9,"Invalid transaction type.")},t}();e.IndexedDBStore=g;var m=function(t){function e(e,n){var r=this;t.call(this),new g(function(t,n){t?e(t):r.init(n,function(t){e(t,r)})},n)}return u(e,t),e.isAvailable=function(){return"undefined"!=typeof l},e}(o.AsyncKeyValueFileSystem);e.IndexedDBFileSystem=m,r.registerFileSystem("IndexedDB",m)}),f("core/global").BrowserFS=f("core/browserfs"),f("generic/emscripten_fs"),f("backend/IndexedDB")}();
//# sourceMappingURL=browserfs.js.map